<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>User modules &mdash; q3dfit 1.1.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=00f267c6"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="MIR Configuration" href="../MIR-configuration.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            q3dfit
          </a>
              <div class="version">
                1.1.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">q3dfit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fitting.html">Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MIR-configuration.html">MIR Configuration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">User modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-q3dfit.q3df">q3dfit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.q3df.q3dfit"><code class="docutils literal notranslate"><span class="pre">q3dfit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-q3dfit.contfit">contfit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.contfit.fitpoly"><code class="docutils literal notranslate"><span class="pre">fitpoly()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.contfit.fitqsohost"><code class="docutils literal notranslate"><span class="pre">fitqsohost()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.contfit.questfit"><code class="docutils literal notranslate"><span class="pre">questfit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.contfit.linfit_plus_FeII"><code class="docutils literal notranslate"><span class="pre">linfit_plus_FeII()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.contfit.Fe_flux_balmer"><code class="docutils literal notranslate"><span class="pre">Fe_flux_balmer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.contfit.Fe_flux_UV"><code class="docutils literal notranslate"><span class="pre">Fe_flux_UV()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.contfit.quest_extract_QSO_contrib"><code class="docutils literal notranslate"><span class="pre">quest_extract_QSO_contrib()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.contfit.readcf"><code class="docutils literal notranslate"><span class="pre">readcf()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-q3dfit.q3dcollect">q3dcollect</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.q3dcollect.q3dcollect"><code class="docutils literal notranslate"><span class="pre">q3dcollect()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#classes">Classes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#q3dfit.readcube.Cube"><code class="docutils literal notranslate"><span class="pre">Cube</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.readcube.Cube.about"><code class="docutils literal notranslate"><span class="pre">Cube.about()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.readcube.Cube.convolve"><code class="docutils literal notranslate"><span class="pre">Cube.convolve()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.readcube.Cube.makeqsotemplate"><code class="docutils literal notranslate"><span class="pre">Cube.makeqsotemplate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.readcube.Cube.specextract"><code class="docutils literal notranslate"><span class="pre">Cube.specextract()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.readcube.Cube.reproject"><code class="docutils literal notranslate"><span class="pre">Cube.reproject()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.readcube.Cube.writefits"><code class="docutils literal notranslate"><span class="pre">Cube.writefits()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.readcube.Cube.writespec"><code class="docutils literal notranslate"><span class="pre">Cube.writespec()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#q3dfit.q3din.q3din"><code class="docutils literal notranslate"><span class="pre">q3din</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.q3din.q3din.init_linefit"><code class="docutils literal notranslate"><span class="pre">q3din.init_linefit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.q3din.q3din.init_contfit"><code class="docutils literal notranslate"><span class="pre">q3din.init_contfit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.q3din.q3din.load_cube"><code class="docutils literal notranslate"><span class="pre">q3din.load_cube()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.q3din.q3din.get_dispersion"><code class="docutils literal notranslate"><span class="pre">q3din.get_dispersion()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.q3din.q3din.get_linelist"><code class="docutils literal notranslate"><span class="pre">q3din.get_linelist()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#internal-modules">Internal modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-q3dfit.checkcomp">checkcomp</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.checkcomp.checkcomp"><code class="docutils literal notranslate"><span class="pre">checkcomp()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-q3dfit.fitloop">fitloop</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.fitloop.fitloop"><code class="docutils literal notranslate"><span class="pre">fitloop()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-q3dfit.fitspec">fitspec</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.fitspec.fitspec"><code class="docutils literal notranslate"><span class="pre">fitspec()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.fitspec.per_iteration"><code class="docutils literal notranslate"><span class="pre">per_iteration()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.fitspec.airtovac"><code class="docutils literal notranslate"><span class="pre">airtovac()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.fitspec.masklin"><code class="docutils literal notranslate"><span class="pre">masklin()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-q3dfit.lineinit">lineinit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.lineinit.lineinit"><code class="docutils literal notranslate"><span class="pre">lineinit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.lineinit.set_params"><code class="docutils literal notranslate"><span class="pre">set_params()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.lineinit.manygauss"><code class="docutils literal notranslate"><span class="pre">manygauss()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-q3dfit.linelist">linelist</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.linelist.linelist"><code class="docutils literal notranslate"><span class="pre">linelist()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-q3dfit.q3df_helperFunctions">q3df_helperFunctions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.q3df_helperFunctions.execute_fitloop"><code class="docutils literal notranslate"><span class="pre">execute_fitloop()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.q3df_helperFunctions.q3df_oneCore"><code class="docutils literal notranslate"><span class="pre">q3df_oneCore()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.q3df_helperFunctions.q3df_multiCore"><code class="docutils literal notranslate"><span class="pre">q3df_multiCore()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.q3df_helperFunctions.string_to_intList"><code class="docutils literal notranslate"><span class="pre">string_to_intList()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-q3dfit.q3dmath">q3dmath</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.q3dmath.interptemp"><code class="docutils literal notranslate"><span class="pre">interptemp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.q3dmath.interp_lis"><code class="docutils literal notranslate"><span class="pre">interp_lis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.q3dmath.cutoff_NaNs"><code class="docutils literal notranslate"><span class="pre">cutoff_NaNs()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-q3dfit.q3dutil">q3dutil</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.q3dutil.get_q3dio"><code class="docutils literal notranslate"><span class="pre">get_q3dio()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.q3dutil.get_spaxels"><code class="docutils literal notranslate"><span class="pre">get_spaxels()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.q3dutil.write_msg"><code class="docutils literal notranslate"><span class="pre">write_msg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.q3dutil.lmlabel"><code class="docutils literal notranslate"><span class="pre">lmlabel</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-q3dfit.qsohostfcn">qsohostfcn</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.qsohostfcn.qso_mult_exp"><code class="docutils literal notranslate"><span class="pre">qso_mult_exp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.qsohostfcn.setup_qso_mult_exp"><code class="docutils literal notranslate"><span class="pre">setup_qso_mult_exp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.qsohostfcn.qso_mult_leg"><code class="docutils literal notranslate"><span class="pre">qso_mult_leg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.qsohostfcn.setup_qso_mult_leg"><code class="docutils literal notranslate"><span class="pre">setup_qso_mult_leg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.qsohostfcn.stars_add_leg"><code class="docutils literal notranslate"><span class="pre">stars_add_leg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.qsohostfcn.setup_stars_add_leg"><code class="docutils literal notranslate"><span class="pre">setup_stars_add_leg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.qsohostfcn.stars_add_exp"><code class="docutils literal notranslate"><span class="pre">stars_add_exp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.qsohostfcn.setup_stars_add_exp"><code class="docutils literal notranslate"><span class="pre">setup_stars_add_exp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.qsohostfcn.qsohostfcn"><code class="docutils literal notranslate"><span class="pre">qsohostfcn()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-q3dfit.questfitfcn">questfitfcn</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.questfitfcn.blackbody"><code class="docutils literal notranslate"><span class="pre">blackbody()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.questfitfcn.set_up_fit_blackbody_model"><code class="docutils literal notranslate"><span class="pre">set_up_fit_blackbody_model()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.questfitfcn.powerlaw"><code class="docutils literal notranslate"><span class="pre">powerlaw()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.questfitfcn.set_up_fit_powerlaw_model"><code class="docutils literal notranslate"><span class="pre">set_up_fit_powerlaw_model()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.questfitfcn.model_scale"><code class="docutils literal notranslate"><span class="pre">model_scale()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.questfitfcn.set_up_fit_model_scale"><code class="docutils literal notranslate"><span class="pre">set_up_fit_model_scale()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.questfitfcn.set_up_absorption"><code class="docutils literal notranslate"><span class="pre">set_up_absorption()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#q3dfit.questfitfcn.set_up_fit_extinction"><code class="docutils literal notranslate"><span class="pre">set_up_fit_extinction()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">q3dfit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">User modules</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/source/q3dfit.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="user-modules">
<h1>User modules<a class="headerlink" href="#user-modules" title="Link to this heading"></a></h1>
<section id="module-q3dfit.q3df">
<span id="q3dfit"></span><h2>q3dfit<a class="headerlink" href="#module-q3dfit.q3df" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.q3df.q3dfit">
<span class="sig-prename descclassname"><span class="pre">q3dfit.q3df.</span></span><span class="sig-name descname"><span class="pre">q3dfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q3din</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onefit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpipath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nocrash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/q3df.html#q3dfit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.q3df.q3dfit" title="Link to this definition"></a></dt>
<dd><p>This is the core routine to fit the continuum and emission lines of
a spectrum. For single-threaded processing, the routine calls
<a class="reference internal" href="#q3dfit.q3df_helperFunctions.q3df_oneCore" title="q3dfit.q3df_helperFunctions.q3df_oneCore"><code class="xref py py-mod docutils literal notranslate"><span class="pre">q3df_oneCore</span></code></a>. For multi-threaded
processing, the routine runs <cite>:py:mod:`~q3dfit.q3df_helperFunctions</cite>
as a script through MPI. This in turn calls
<a class="reference internal" href="#q3dfit.q3df_helperFunctions.q3df_multiCore" title="q3dfit.q3df_helperFunctions.q3df_multiCore"><code class="xref py py-mod docutils literal notranslate"><span class="pre">q3df_multiCore</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q3din</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | <a class="reference internal" href="#q3dfit.q3din.q3din" title="q3dfit.q3din.q3din"><code class="xref py py-class docutils literal notranslate"><span class="pre">q3din</span></code></a></span>) – Either a string with the path to the numpy save file containing the
input initialization object <a class="reference internal" href="#q3dfit.q3din.q3din" title="q3dfit.q3din.q3din"><code class="xref py py-class docutils literal notranslate"><span class="pre">q3din</span></code></a>,
or the object itself.</p></li>
<li><p><strong>cols</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>) – Optional. Column values for spaxels to be fitted. Default is None, which means
all columns will be fitted. If a scalar, only that column will be fitted. If a
2-element list, the elements are the starting and ending columns to be
fitted. Unity-offset values assumed.</p></li>
<li><p><strong>rows</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>) – Optional. Row values for spaxels to be fitted. Default is None, which means
all rows will be fitted. If a scalar, only that row will be fitted. If a
2-element list, the elements are the starting and ending rows to be
fitted. Unity-offset values assumed.</p></li>
<li><p><strong>onefit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. If set, only one fit is performed in <a class="reference internal" href="#q3dfit.fitloop.fitloop" title="q3dfit.fitloop.fitloop"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fitloop</span></code></a>.
Default is False.</p></li>
<li><p><strong>ncores</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Optional. Number of cores for parallel processing. Default is 1.</p></li>
<li><p><strong>quiet</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. If False, some progress messages are written to stdout.
Default is True. If a logfile is specified in <a class="reference internal" href="#q3dfit.q3din.q3din" title="q3dfit.q3din.q3din"><code class="xref py py-class docutils literal notranslate"><span class="pre">q3din</span></code></a>,
these messages are written to the logfile as well. Some messages appear only
in the logfile.</p></li>
<li><p><strong>mpipath</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span>) – Optional. Path to the MPI executable. Default is None.</p></li>
<li><p><strong>nocrash</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. If set, the routine will continue with the next spaxel in case
of a crash. Default is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-q3dfit.contfit">
<span id="contfit"></span><h2>contfit<a class="headerlink" href="#module-q3dfit.contfit" title="Link to this heading"></a></h2>
<p>Continuum fitting routines and subroutines.</p>
<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.contfit.fitpoly">
<span class="sig-prename descclassname"><span class="pre">q3dfit.contfit.</span></span><span class="sig-name descname"><span class="pre">fitpoly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/contfit.html#fitpoly"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.contfit.fitpoly" title="Link to this definition"></a></dt>
<dd><p>Fit the continuum as a polynomial.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Wavelengths</p></li>
<li><p><strong>flux</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Fluxes</p></li>
<li><p><strong>weight</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Weights</p></li>
<li><p><strong>index</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Points used in the fit.</p></li>
<li><p><strong>logfile</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span>) – Optional. Name of the log file. Default is None.</p></li>
<li><p><strong>quiet</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Suppress output to stdout? Default is True.</p></li>
<li><p><strong>fitord</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Optional. Order of the polynomial. Default is 3.</p></li>
<li><p><strong>refit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, ArrayLike]]</span>) – Optional. Refit with a different polynomial order? If so, set to dictionary
with keys ‘ord’ and ‘ran’ for the order and range of the
refit, respectively. Can specify multiple ranges and orders as
array_like. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, ArrayLike, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>np.ndarray</em> – best fit continuum model</p></li>
<li><p><em>ArrayLike</em> – Polynomial coefficients.</p></li>
<li><p><em>None</em> – Unused</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.contfit.fitqsohost">
<span class="sig-prename descclassname"><span class="pre">q3dfit.contfit.</span></span><span class="sig-name descname"><span class="pre">fitqsohost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template_wave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template_flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zstar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">siginit_stars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_poly_degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitran</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qsoord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hostord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blrpar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qsoonly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hostonly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blronly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qsoxdr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/contfit.html#fitqsohost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.contfit.fitqsohost" title="Link to this definition"></a></dt>
<dd><p>Fit the continuum using a quasar template and a stellar template. Calls
<a class="reference internal" href="#q3dfit.qsohostfcn.qsohostfcn" title="q3dfit.qsohostfcn.qsohostfcn"><code class="xref py py-func docutils literal notranslate"><span class="pre">qsohostfcn()</span></code></a> to jointly fit the quasar and host
galaxy components. Calls <code class="xref py py-func docutils literal notranslate"><span class="pre">ppxf()</span></code> or <a class="reference internal" href="#q3dfit.contfit.questfit" title="q3dfit.contfit.questfit"><code class="xref py py-func docutils literal notranslate"><span class="pre">questfit()</span></code></a>
to refit the residual after subtracting the quasar component.</p>
<p>Additional keywords can be passed to <a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.Model.fit" title="(in lmfit v1.3.2)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> by passing
them as keyword arguments to this function. Arguments to the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize" title="(in SciPy v1.14.1)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optimize</span></code></a>
functions can be passed by setting the keyword argument <cite>argslmfit</cite> to a dictionary of
parameter names and values as keys and values. Arguments to
<a class="reference internal" href="#q3dfit.contfit.questfit" title="q3dfit.contfit.questfit"><code class="xref py py-func docutils literal notranslate"><span class="pre">questfit()</span></code></a> for the <cite>refit</cite> can be passed by setting the
keyword argument <cite>args_questfit</cite> to a dictionary of parameter names and values as
keys and values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Wavelengths</p></li>
<li><p><strong>flux</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Fluxes</p></li>
<li><p><strong>weight</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Weights</p></li>
<li><p><strong>index</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Points used in the fit.</p></li>
<li><p><strong>logfile</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span>) – Optional. Name of the log file. Default is None.</p></li>
<li><p><strong>quiet</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Suppress output to stdout? Default is True.</p></li>
<li><p><strong>fitran</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[ArrayLike]</span>) – Optional. Wavelength range to fit. Default is None, to fit all wavelengths.</p></li>
<li><p><strong>qsoord</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – Optional. Order of the polynomial added to the quasar multiplier.
Default is None.</p></li>
<li><p><strong>hostord</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – Optional. Order of the polynomial model for the host galaxy.
Default is None.</p></li>
<li><p><strong>blrpar</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[ArrayLike]</span>) – Optional. Parameters of the broad line region scattering model. If set,
fit this part of the model. Set to array_like Default is None.</p></li>
<li><p><strong>qsoonly</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Fit only the quasar template. Default is False.</p></li>
<li><p><strong>hostonly</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Fit only the host galaxy. Default is False.</p></li>
<li><p><strong>blronly</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Fit only the broad line region scattering model. Default is False.</p></li>
<li><p><strong>refit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span>) – Optional. Refit the continuum residual after subtracting the quasar.
Options are ‘ppxf’ or ‘questfit’.</p></li>
<li><p><strong>template_wave</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]</span>) – Optional, but must be set if refit=’ppxf’. Wavelength array of the stellar
template used as model for stellar continuum.</p></li>
<li><p><strong>template_flux</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]</span>) – Optional, but must be set if refit=’ppxf’. Wavelength array of the stellar
template used as model for stellar continuum.</p></li>
<li><p><strong>zstar</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Optional, but must be set if refit=’ppxf’. Input guess for redshift of the
stellar continuum. Default is 0.</p></li>
<li><p><strong>flux_log</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]</span>) – Optional, but must be set if refit=’ppxf’. Flux values for the log-rebinned
pixels.</p></li>
<li><p><strong>err_log</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]</span>) – Optional, but must be set if refit=’ppxf’. Error values for the log-rebinned
pixels.</p></li>
<li><p><strong>index_log</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]</span>) – Optional, but must be set if refit=’ppxf’. Pixels used in the fit for the
pPXF fit, as log-rebinned.</p></li>
<li><p><strong>siginit_stars</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Optional. Initial guess for the stellar velocity dispersion in km/s, used
in the pPXF fit. Default is 50. km/s.</p></li>
<li><p><strong>add_poly_degree</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Optional. Degree of the additive polynomial for the pPXF fit. Default is
30.</p></li>
<li><p><strong>qsoxdr</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Path and filename for the quasar template.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>numpy.ndarray</em> – Best fit continuum model.</p></li>
<li><p><em>dict[str, Any]</em> – Best fit parameters. The exact form will depend on the value of the
refit parameter. If refit is None, this will be the best fit parameters
from the initial fit. If refit is ‘ppxf’, this will be a dictionary with
keys ‘qso_host’, ‘stel’, ‘poly’, and ‘ppxf_sigma’. If refit is ‘questfit’,
this will be a dictionary with keys ‘qso_host’, ‘stel’, and ‘poly’.</p></li>
<li><p><em>float</em> – Best fit stellar redshift if refit=’ppxf’. Otherwise, the input redshift.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.contfit.questfit">
<span class="sig-prename descclassname"><span class="pre">q3dfit.contfit.</span></span><span class="sig-name descname"><span class="pre">questfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tempdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/contfit.html#questfit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.contfit.questfit" title="Link to this definition"></a></dt>
<dd><p>Fit the MIR continuum. Calls <code class="xref py py-func docutils literal notranslate"><span class="pre">questfitfcn()</span></code> to fit the
continuum using the templates specified in the configuration file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Wavelengths</p></li>
<li><p><strong>flux</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Fluxes</p></li>
<li><p><strong>weight</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Weights</p></li>
<li><p><strong>index</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Points used in the fit.</p></li>
<li><p><strong>quiet</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Suppress output? Default is True.</p></li>
<li><p><strong>z</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Optional. Redshift of the source, for redshifting the templates.
Default is 0.</p></li>
<li><p><strong>fluxunit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span>) – Optional. Units of the flux, as defined by <a class="reference internal" href="#q3dfit.readcube.Cube" title="q3dfit.readcube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a>.
Default is None. The templates are assumed to be in f_nu. If this
unit contains ‘micron’ or ‘Angstrom’, the flux is assumed to be in f_lambda.
The templates are then converted to f_lambda. If None, the templates are not
converted.</p></li>
<li><p><strong>tempdir</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span>) – Optional. Directory containing the templates, to search if default
directory does not contain template. Default is None.</p></li>
<li><p><strong>config_file</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Configuration file for the fit.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>numpy.ndarray</em> – Best fit continuum model.</p></li>
<li><p><em>dict[str, Any]</em> – Best fit parameters. Key ‘MIRparams’ is a <code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code> object
containing the best fit parameters. Key ‘comp_best_fit’ is a dictionary
containing with key/value pairs of the component names and their values
evaluated at the best fit parameters.</p></li>
<li><p><em>z</em> – Same as input z.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.contfit.linfit_plus_FeII">
<span class="sig-prename descclassname"><span class="pre">q3dfit.contfit.</span></span><span class="sig-name descname"><span class="pre">linfit_plus_FeII</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unused1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unused2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zstar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specConv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Fe_FWHM</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Fe_FWHM_UV</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/contfit.html#linfit_plus_FeII"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.contfit.linfit_plus_FeII" title="Link to this definition"></a></dt>
<dd><p>This function fits the continuum as a superposition of a linear fit and
an FeII template.
* Optical FeII template:  taken from Vestergaard &amp; Wilkes (2001).
* UV FeII template: following the PyQSOFit code (Guo et al. 2018):</p>
<blockquote>
<div><p>template by Shen et al. (2019) - composite of
Vestergaard &amp; Wilkes (2001), Tsuzuki et al. (2006) and
Salviander et al. (2007)</p>
</div></blockquote>
<p>The UV and optical FeII templates are scaled up/down separately
from each other.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lam</strong> (<em>array</em>) – wavelength</p></li>
<li><p><strong>flux</strong> (<em>array</em>) – Flux values to be fit</p></li>
<li><p><strong>weight</strong> (<em>array</em>) – Weights of each individual pixel to be fit</p></li>
<li><p><strong>unused1</strong> – Not used in this function.</p></li>
<li><p><strong>unused2</strong> – Not used in this function.</p></li>
<li><p><strong>index</strong> (<em>array</em>) – Pixels used in the fit</p></li>
<li><p><strong>zstar</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – redshift of the stellar continuum</p></li>
<li><p><strong>specConv</strong> (<em>instance</em><em> of </em><em>the spectConvol class</em>) – specifying the instrumental spectral resolution convolution</p></li>
<li><p><strong>outdir</strong> (<em>string</em>) – directory for saving the output log</p></li>
<li><p><strong>quiet</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – not used in this function</p></li>
<li><p><strong>refit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – not used in this function</p></li>
<li><p><strong>rows</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – row(s) and column(s) of the input cube in which the fitting is done.
Used only to define the name of the output log</p></li>
<li><p><strong>cols</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – row(s) and column(s) of the input cube in which the fitting is done.
Used only to define the name of the output log</p></li>
<li><p><strong>Fe_FWHM</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Defines the smoothing of the FeII template in km/s. FWHM of the Gaussian smoothing that will be applied. Needs to be &gt;900 km/s (FWHM of template).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>continuum</strong> (<em>array</em>) – best fit continuum model</p></li>
<li><p><strong>ct_coeff</strong> (<em>dictionary or lmfit best fit params structure</em>) – best fit parameters</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.contfit.Fe_flux_balmer">
<span class="sig-prename descclassname"><span class="pre">q3dfit.contfit.</span></span><span class="sig-name descname"><span class="pre">Fe_flux_balmer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Fe_FWHM</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zstar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specConv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/contfit.html#Fe_flux_balmer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.contfit.Fe_flux_balmer" title="Link to this definition"></a></dt>
<dd><p>Loads the optical FeII template, redshifts it,
convolves it with the intrinsic broadening, and convolves it
with the instrumental resolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Fe_FWHM</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Defines the smoothing of the FeII template in km/s. FWHM of the
Gaussian smoothing that will be applied. Needs to be &gt;900 km/s
(FWHM of template).</p></li>
<li><p><strong>zstar</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Redshift of the stellar continuum.</p></li>
<li><p><strong>specConv</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></span>) – Instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">spectConvol</span></code> specifying
the instrumental spectral resolution convolution.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>np.ndarray</em> – Convolved FeII template.</p></li>
<li><p><em>np.ndarray</em> – Wavelength array of the FeII template.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.contfit.Fe_flux_UV">
<span class="sig-prename descclassname"><span class="pre">q3dfit.contfit.</span></span><span class="sig-name descname"><span class="pre">Fe_flux_UV</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Fe_FWHM</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zstar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specConv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/contfit.html#Fe_flux_UV"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.contfit.Fe_flux_UV" title="Link to this definition"></a></dt>
<dd><p>This function loads the UV FeII template, redshifts it,
convolves it with the intrinsic broadening, and convolves it
with the instrumental resolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Fe_FWHM</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Defines the smoothing of the FeII template in km/s. FWHM of the
Gaussian smoothing that will be applied. Needs to be &gt;900 km/s
(FWHM of template).</p></li>
<li><p><strong>zstar</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Redshift of the stellar continuum.</p></li>
<li><p><strong>specConv</strong> (<em>instance</em><em> of </em><em>the spectConvol class</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>F_Fe_uv_conv</strong> (<em>array</em>) – Convolved FeII template.</p></li>
<li><p><strong>wave_fe</strong> (<em>array</em>) – Wavelength array of the FeII template.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.contfit.quest_extract_QSO_contrib">
<span class="sig-prename descclassname"><span class="pre">q3dfit.contfit.</span></span><span class="sig-name descname"><span class="pre">quest_extract_QSO_contrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ct_coeff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initdat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/contfit.html#quest_extract_QSO_contrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.contfit.quest_extract_QSO_contrib" title="Link to this definition"></a></dt>
<dd><p>This function can be used to recover the QSO-host decomposition after running questfit</p>
<dl class="field-list simple">
<dt class="field-odd">Params<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ct_coeff: in, required, type=dict</dt><dd><p>dict returned by questfit containing the continuum fitting results</p>
</dd>
<dt>initdat: in, required, type=dict</dt><dd><p>dict that was used to initialize the fit</p>
</dd>
<dt>qso_out_ext: out, type=array</dt><dd><p>spectrum of the QSO component (with dust extinction and ice absorption)</p>
</dd>
<dt>host_out_ext:  out, type=array</dt><dd><p>spectrum of the host component (with dust extinction and ice absorption)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.contfit.readcf">
<span class="sig-prename descclassname"><span class="pre">q3dfit.contfit.</span></span><span class="sig-name descname"><span class="pre">readcf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/contfit.html#readcf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.contfit.readcf" title="Link to this definition"></a></dt>
<dd><p>Read in the configuration file for fitting with questfit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Name of, and path, to the configuration file.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>dict</em> – Dictionary with the configuration file. Keys are the names of the
components to be fitted, values are lists with the parameters for
the components.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-q3dfit.q3dcollect">
<span id="q3dcollect"></span><h2>q3dcollect<a class="headerlink" href="#module-q3dfit.q3dcollect" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.q3dcollect.q3dcollect">
<span class="sig-prename descclassname"><span class="pre">q3dfit.q3dcollect.</span></span><span class="sig-name descname"><span class="pre">q3dcollect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q3di</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compsortpar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sigma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compsortdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'up'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignoreres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/q3dcollect.html#q3dcollect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.q3dcollect.q3dcollect" title="Link to this definition"></a></dt>
<dd><p>Collate spaxel information together. As input, it requires a
<code class="xref py py-class docutils literal notranslate"><span class="pre">q3dout</span></code>
objects output by the fit.</p>
<p>Nothing is returned, but the result is saved to {0.outdir}{0.label}’.format(q3dii)+’.line.npz’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q3di</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | <a class="reference internal" href="#q3dfit.q3din.q3din" title="q3dfit.q3din.q3din"><code class="xref py py-class docutils literal notranslate"><span class="pre">q3din</span></code></a></span>) – <a class="reference internal" href="#q3dfit.q3din.q3din" title="q3dfit.q3din.q3din"><code class="xref py py-class docutils literal notranslate"><span class="pre">q3din</span></code></a> object or file name.</p></li>
<li><p><strong>cols</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>) – Optional. Column values for spaxels to be collated. Default is None, which means
all columns will be collated. If a scalar, only that column will be collated. If a
2-element list, the elements are the starting and ending columns to be
collated. Unity-offset values assumed.</p></li>
<li><p><strong>rows</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>) – Optional. Column values for spaxels to be collated. Default is None, which means
all columns will be collated. If a scalar, only that column will be collated. If a
2-element list, the elements are the starting and ending columns to be
collated. Unity-offset values assumed.</p></li>
<li><p><strong>quiet</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. If True, suppresses output to stdout. Default is True.</p></li>
<li><p><strong>compsortpar</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'flux'</span></code>, <code class="docutils literal notranslate"><span class="pre">'sigma'</span></code>, <code class="docutils literal notranslate"><span class="pre">'wave'</span></code>]</span>) – Optional. Parameter by which to sort components. Options are ‘sigma’, ‘flux’,
‘wave’. Default is ‘sigma’.</p></li>
<li><p><strong>compsortdir</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'down'</span></code>, <code class="docutils literal notranslate"><span class="pre">'up'</span></code>]</span>) – Optional. Direction in which to sort components. Options are ‘up’ and ‘down’.
Default is ‘up’.</p></li>
<li><p><strong>ignoreres</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Parameter passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">sepfitpars()</span></code>.
If True, ignore spectral resolution in computing observed sigmas and peak fluxes.
This is mainly for backward compatibility with old versions, which did not store the
spectral resolution in an easily accessible way in the specConv object.
Default is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="classes">
<h1>Classes<a class="headerlink" href="#classes" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="q3dfit.readcube.Cube">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">q3dfit.readcube.</span></span><span class="sig-name descname"><span class="pre">Cube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dqext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmapext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zerodq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invvar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxnorm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxunit_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MJy/sr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxunit_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'erg/s/cm2/micron/sr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usebunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixarea_sqas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">waveunit_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'micron'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">waveunit_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'micron'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usecunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/readcube.html#Cube"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.readcube.Cube" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Read in and contain a data cube and associated information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>infile</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Name of input FITS file.</p></li>
<li><p><strong>datext</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Optional. Extension number of data. Defaults to 1.</p></li>
<li><p><strong>varext</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Optional. Extension number of variance. Defaults to 2.</p></li>
<li><p><strong>dqext</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – Optional. Extension number of data quality. Defaults to 3. If DQ
extension is not present, set to None. This will set all DQ values
to 0.</p></li>
<li><p><strong>wmapext</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – Optional. Extension number  of weight. Defaults to 4. If weight
extension is not present, set to None.</p></li>
<li><p><strong>wavext</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – Optional. Extension number of wavelength data. Defaults to None.</p></li>
<li><p><strong>zerodq</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Zero out the DQ array. Default is False. Even if dqext
is present, this will set all DQ values to 0.</p></li>
<li><p><strong>error</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. If the variance extension contains errors rather than
variance, set to True. Defaults to False.</p></li>
<li><p><strong>invvar</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. If the variance extension contains inverse variance rather
than variance, set to True. Defaults to False.</p></li>
<li><p><strong>fluxnorm</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Optional. Factor by which to divide the data. Defaults to 1.</p></li>
<li><p><strong>fluxunit_in</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Optional. Flux unit of input data cube. Default is <cite>MJy/sr</cite> (JWST
default). Must be parseable by <a class="reference external" href="https://docs.astropy.org/en/stable/units/ref_api.html#module-astropy.units" title="(in Astropy v6.1)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">units</span></code></a>.</p></li>
<li><p><strong>fluxunit_out</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Optional. Flux unit carried by object. Default is
<cite>erg/s/cm2/micron/sr</cite>. Must be parseable by <a class="reference external" href="https://docs.astropy.org/en/stable/units/ref_api.html#module-astropy.units" title="(in Astropy v6.1)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">units</span></code></a>.</p></li>
<li><p><strong>usebunit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. If BUNIT and fluxunit_in differ, default to BUNIT.
Default is False.</p></li>
<li><p><strong>pixarea_sqas</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</span>) – Optional. Spaxel area in square arcseconds. If present and
flux units are per sr or per square arcseconds, will convert surface
brightness units to flux per spaxel. Default is None. If set to None and
header contains PIXAR_A2, routine will use that value.</p></li>
<li><p><strong>waveunit_in</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Optional. Wavelength unit of input data cube. Default is <cite>micron</cite>.</p></li>
<li><p><strong>waveunit_out</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Optional. Wavelength unit carried by object. Default is <cite>micron</cite>.</p></li>
<li><p><strong>usecunit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. If CUNIT and waveunit_in differ, default to CUNIT.
Default is False.</p></li>
<li><p><strong>logfile</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span>) – Optional. Filename for progress messages. Default is None.</p></li>
<li><p><strong>quiet</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Send progress messages to stdout. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>dat</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><em>numpy.ndarray</em></a>) – Data array (ncols, nrows, nwave).</p></li>
<li><p><strong>var</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><em>numpy.ndarray</em></a>) – Variance array (ncols, nrows, nwave).</p></li>
<li><p><strong>err</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><em>numpy.ndarray</em></a>) – Error array (ncols, nrows, nwave). Recorded as nan when the variance is negative.</p></li>
<li><p><strong>dq</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><em>numpy.ndarray</em></a>) – Data quality array (ncols, nrows, nwave).</p></li>
<li><p><strong>wmap</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><em>numpy.ndarray</em></a>) – Weight (1/variance) array (ncols, nrows, nwave). If wmap extension is not present,
set to None.</p></li>
<li><p><strong>wave</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><em>numpy.ndarray</em></a>) – Wavelength array (nwave).</p></li>
<li><p><strong>cdelt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Constant dispersion. If a wavelength extension is present, this is the difference
between the first two wavelengths.</p></li>
<li><p><strong>crpix</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – WCS pixel zero point, in unity-offset coordinates. If a wavelength extension is
present, this is the first pixel (i.e., 1).</p></li>
<li><p><strong>crval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – WCS wavelength zero point. If a wavelength extension is present, this is the first
wavelength.</p></li>
<li><p><strong>header_phu</strong> (<a class="reference external" href="https://docs.astropy.org/en/stable/io/fits/api/headers.html#astropy.io.fits.Header" title="(in Astropy v6.1)"><em>astropy.io.fits.Header</em></a>) – Primary header data unit.</p></li>
<li><p><strong>header_dat</strong> (<a class="reference external" href="https://docs.astropy.org/en/stable/io/fits/api/headers.html#astropy.io.fits.Header" title="(in Astropy v6.1)"><em>astropy.io.fits.Header</em></a>) – Header for the data extension.</p></li>
<li><p><strong>header_var</strong> (<a class="reference external" href="https://docs.astropy.org/en/stable/io/fits/api/headers.html#astropy.io.fits.Header" title="(in Astropy v6.1)"><em>astropy.io.fits.Header</em></a>) – Header for the variance extension.</p></li>
<li><p><strong>header_dq</strong> (<a class="reference external" href="https://docs.astropy.org/en/stable/io/fits/api/headers.html#astropy.io.fits.Header" title="(in Astropy v6.1)"><em>astropy.io.fits.Header</em></a>) – Optional. Header for the data quality extension. If dq extension is not present,
set to None.</p></li>
<li><p><strong>header_wmap</strong> (<a class="reference external" href="https://docs.astropy.org/en/stable/io/fits/api/headers.html#astropy.io.fits.Header" title="(in Astropy v6.1)"><em>astropy.io.fits.Header</em></a>) – Optional. Header for the wmap extension. If wmap extension is not present,
set to None.</p></li>
<li><p><strong>cubedim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of dimensions of the “cube” (1, 2, or 3).</p></li>
<li><p><strong>ncols</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of columns.  If the data are 1D, this is 1. If the data are 2D, this is the
number of spectra.</p></li>
<li><p><strong>nrows</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of rows. If the data are 1D or 2D, this is 1.</p></li>
<li><p><strong>nwave</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of wavelength elements.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">q3dfit</span> <span class="kn">import</span> <span class="n">readcube</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cube</span> <span class="o">=</span> <span class="n">readcube</span><span class="o">.</span><span class="n">Cube</span><span class="p">(</span><span class="s1">&#39;infile.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cube</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="mf">2.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cube</span><span class="o">.</span><span class="n">writefits</span><span class="p">(</span><span class="s1">&#39;outfile.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="q3dfit.readcube.Cube.about">
<span class="sig-name descname"><span class="pre">about</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/readcube.html#Cube.about"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.readcube.Cube.about" title="Link to this definition"></a></dt>
<dd><p>Print information about the cube to stdout.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="q3dfit.readcube.Cube.convolve">
<span class="sig-name descname"><span class="pre">convolve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">refsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'circle'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/readcube.html#Cube.convolve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.readcube.Cube.convolve" title="Link to this definition"></a></dt>
<dd><p>Spatially smooth a cube. Updates the data, variance, and error attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>refsize</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Pixel size for smoothing algorithm.</p></li>
<li><p><strong>wavescale</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Scale smoothing size with wavelength. Default is False.</p></li>
<li><p><strong>method</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'circle'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Gaussian'</span></code>, <code class="docutils literal notranslate"><span class="pre">'boxcar'</span></code>]</span>) – Optional. Smoothing method. Options are ‘circle’, ‘Gaussian’, and
‘boxcar’. Default is ‘circle’.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="q3dfit.readcube.Cube.makeqsotemplate">
<span class="sig-name descname"><span class="pre">makeqsotemplate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outpy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/readcube.html#Cube.makeqsotemplate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.readcube.Cube.makeqsotemplate" title="Link to this definition"></a></dt>
<dd><p>Extract the quasar spectrum and save it to a numpy file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outpy</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Name of the numpy save file for the resulting qso spectrum.</p></li>
<li><p><strong>col</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – Optional. x value of aperture center, in unity-offset
coordinates. Default is None, in which case the cube is median-
collapsed in wavelength and the peak spaxel is used.</p></li>
<li><p><strong>row</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – Optional.yx value of aperture center, in unity-offset
coordinates. Default is None, in which case the cube is median-
collapsed in wavelength and the peak spaxel is used.</p></li>
<li><p><strong>norm</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Optional. Factor by which to divide output spectrum. Default is 1.</p></li>
<li><p><strong>plot</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Plot extracted spectrum. Default is True.</p></li>
<li><p><strong>radius</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Optional. Radius for circular extraction. Must be &gt; 0. Default is 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="q3dfit.readcube.Cube.specextract">
<span class="sig-name descname"><span class="pre">specextract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/readcube.html#Cube.specextract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.readcube.Cube.specextract" title="Link to this definition"></a></dt>
<dd><p>Extract a spectrum in a single spaxel or a circular aperture.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>col</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – x value of aperture center, in unity-offset coordinates.</p></li>
<li><p><strong>row</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – y value of aperture center, in unity-offset coordinates.</p></li>
<li><p><strong>radius</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Optional. Radius for circular extraction. If 0, extract single
spaxel. Default is 1.</p></li>
<li><p><strong>norm</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Optional. Factor by which to divide output spectrum. Default is 1.</p></li>
<li><p><strong>plot</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Plot extracted spectrum.</p></li>
<li><p><strong>ylim</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>]</span>) – Optional. Y-axis limits for plot. Default is None, in which case
the plot will autoscale.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>numpy.ndarray</em> – Array of size nwave x (1-3), including data and var and/or dq if
present.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="q3dfit.readcube.Cube.reproject">
<span class="sig-name descname"><span class="pre">reproject</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">newheader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new2dshape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newpixarea_sqas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/readcube.html#Cube.reproject"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.readcube.Cube.reproject" title="Link to this definition"></a></dt>
<dd><p>Reproject cube onto a new WCS. Overwrites the data, variance, dq, and
error attributes. Also updates the pixel area, nrows, ncols, and
PIXEL_A2 keyword in the header.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>newheader</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></span>) – Header object containing new WCS information.</p></li>
<li><p><strong>new2dshape</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Buffer" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Buffer</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">_SupportsArray</span></code>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]], <code class="xref py py-class docutils literal notranslate"><span class="pre">_NestedSequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">_SupportsArray</span></code>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]], <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">complex</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">_NestedSequence</span></code>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">complex</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a>]]</span>) – 2-element array containing (nrows, ncols).</p></li>
<li><p><strong>newpixarea_sqas</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Pixel area in square arcseconds.</p></li>
<li><p><strong>parallel</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Use parallel processing when computing
reprojection. Default is True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="q3dfit.readcube.Cube.writefits">
<span class="sig-name descname"><span class="pre">writefits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/readcube.html#Cube.writefits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.readcube.Cube.writefits" title="Link to this definition"></a></dt>
<dd><p>Write cube to file outfile. Assumes extension order empty phu (if
present in original fits file), datext, varext, dqext, and wmapext.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>outfile</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Name of output file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="q3dfit.readcube.Cube.writespec">
<span class="sig-name descname"><span class="pre">writespec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/readcube.html#Cube.writespec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.readcube.Cube.writespec" title="Link to this definition"></a></dt>
<dd><p>Write extracted spectrum to disk. Assumes extension order empty phu (if
present in original fits file), datext, varext, dqext, and wmapext.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</span>) – Array of size nwave x (1-3), including data and var and/or dq if
present.</p></li>
<li><p><strong>outfile</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Name of output file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="q3dfit.q3din.q3din">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">q3dfit.q3din.</span></span><span class="sig-name descname"><span class="pre">q3din</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">argsreadcube</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spect_convol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zsys_gas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vacuum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dqext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/q3din.html#q3din"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.q3din.q3din" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Initialize fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>infile</strong> – Name of input FITS file.
Also sets the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">infile</span></code>.</p></li>
<li><p><strong>label</strong> – Shorthand label for filenames.
Also sets the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">label</span></code>.</p></li>
<li><p><strong>argsreadcube</strong> – Optional. Dict of parameter name/value pairs to pass to
<a class="reference internal" href="#q3dfit.readcube.Cube" title="q3dfit.readcube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a>. Default is an empty dictionary.
Also sets the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">argsreadcube</span></code>.</p></li>
<li><p><strong>cutrange</strong> – Optional. Set of wavelength limits to cut out of fit. Default is None.
Also sets the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">cutrange</span></code>.</p></li>
<li><p><strong>fitrange</strong> – Optional. Set of wavelength limits to fit. Default is None, which
means fit the entire range. Also sets the attribute
<code class="xref py py-attr docutils literal notranslate"><span class="pre">fitrange</span></code>.</p></li>
<li><p><strong>logfile</strong> – Optional. Filename to which to print progess messages. Default is None.
Also sets the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">logfile</span></code>.</p></li>
<li><p><strong>name</strong> – Optional. Full name of source for plot labels, etc. Default is None.
Also sets the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code>.</p></li>
<li><p><strong>outdir</strong> – Optional. Output directory for files. Default is None, which means
the current directory. Also sets the attribute
<code class="xref py py-attr docutils literal notranslate"><span class="pre">outdir</span></code>.</p></li>
<li><p><strong>spect_convol</strong> – Optional. Input dictionary to pass to <code class="xref py py-class docutils literal notranslate"><span class="pre">spectConvol</span></code>.
Default is an empty dictionary, which means no convolution. Also sets the
attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">spect_convol</span></code>.</p></li>
<li><p><strong>zsys_gas</strong> – Optional. Systemic redshift of galaxy. Default is None. Also sets the attribute
<code class="xref py py-attr docutils literal notranslate"><span class="pre">zsys_gas</span></code>. Sets the initial guess for redshift
in the line fit and/or continuum fit if not None and not overridden by the user
with the zinit parameter. Also serves as the systemic redshift in
<code class="xref py py-class docutils literal notranslate"><span class="pre">q3dpro</span></code>, if not None and not overridden by the user
with the zsys parameter in <code class="xref py py-class docutils literal notranslate"><span class="pre">q3dpro</span></code>.</p></li>
<li><p><strong>vacuum</strong> – Optional. Are wavelengths in vacuum? Default is True. Also sets the attribute
<code class="xref py py-attr docutils literal notranslate"><span class="pre">vacuum</span></code>.</p></li>
<li><p><strong>datext</strong> – Optional. Extension number for data array in FITS. Default is 1. Also sets the
attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">datext</span></code>.</p></li>
<li><p><strong>varext</strong> – Optional. Extension number for variance array in FITS. Default is 2. Also sets the
attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">varext</span></code>.</p></li>
<li><p><strong>dqext</strong> – Optional. Extension number for data quality array in FITS. Default is 3. Also
sets the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">dqext</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>docontfit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – Is the continuum fit? Set to False by default. Added by
constructor and updated to True by
<a class="reference internal" href="#q3dfit.q3din.q3din.init_contfit" title="q3dfit.q3din.q3din.init_contfit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init_contfit()</span></code></a>.</p></li>
<li><p><strong>dolinefit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – Are emission lines fit? Set to False by default. Added by
constructor and updated to True by
<a class="reference internal" href="#q3dfit.q3din.q3din.init_linefit" title="q3dfit.q3din.q3din.init_linefit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init_linefit()</span></code></a>.</p></li>
<li><p><strong>lines</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a>) – List of lines to fit. Added by <a class="reference internal" href="#q3dfit.q3din.q3din.init_linefit" title="q3dfit.q3din.q3din.init_linefit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init_linefit()</span></code></a>.</p></li>
<li><p><strong>ncomp</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><em>numpy.ndarray</em></a><em>]</em>) – # of components for each fitted line and spaxel. Added by
<a class="reference internal" href="#q3dfit.q3din.q3din.init_linefit" title="q3dfit.q3din.q3din.init_linefit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init_linefit()</span></code></a>.</p></li>
<li><p><strong>siginit_gas</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><em>numpy.ndarray</em></a><em>]</em>) – Initial guess for sigma for each line, spaxel, and component. Added by
<a class="reference internal" href="#q3dfit.q3din.q3din.init_linefit" title="q3dfit.q3din.q3din.init_linefit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init_linefit()</span></code></a>.</p></li>
<li><p><strong>siglim_gas</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><em>numpy.ndarray</em></a><em>]</em>) – Lower and upper limits for sigma for each line, spaxel, and component. Added by
<a class="reference internal" href="#q3dfit.q3din.q3din.init_linefit" title="q3dfit.q3din.q3din.init_linefit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init_linefit()</span></code></a>.</p></li>
<li><p><strong>zinit_gas</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><em>numpy.ndarray</em></a><em>]</em>) – Initial guess for redshift for each line, spaxel, and component. Added by
<a class="reference internal" href="#q3dfit.q3din.q3din.init_linefit" title="q3dfit.q3din.q3din.init_linefit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init_linefit()</span></code></a>.</p></li>
<li><p><strong>linetie</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>]</em>) – Anchor line for a group of one or more lines. Each line in the group
is tied to the others in velocity. Each group is independent. Each key corresponds
to a line being fit, and the value is the anchor line.
Added by <a class="reference internal" href="#q3dfit.q3din.q3din.init_linefit" title="q3dfit.q3din.q3din.init_linefit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init_linefit()</span></code></a>.</p></li>
<li><p><strong>linevary</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>[</em><em>Literal</em><em>[</em><em>'flx'</em><em>,</em><em>'cwv'</em><em>,</em><em>'sig'</em><em>]</em><em>, </em><em>numpy.ndarray</em><em>]</em><em>]</em>) – Flags to vary flux, central wavelength, and sigma for each
line, spaxel, and component. Added by <a class="reference internal" href="#q3dfit.q3din.q3din.init_linefit" title="q3dfit.q3din.q3din.init_linefit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init_linefit()</span></code></a>.</p></li>
<li><p><strong>siginit_gas</strong> – Initial guess for sigma for each line, spaxel, and component. Added by
<a class="reference internal" href="#q3dfit.q3din.q3din.init_linefit" title="q3dfit.q3din.q3din.init_linefit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init_linefit()</span></code></a>.</p></li>
<li><p><strong>siginit_stars</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><em>numpy.ndarray</em></a>) – Initial guess for stellar velocity dispersion for each spaxel, if fitting a
stellar template. Added by <a class="reference internal" href="#q3dfit.q3din.q3din.init_contfit" title="q3dfit.q3din.q3din.init_contfit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init_contfit()</span></code></a>.</p></li>
<li><p><strong>zinit_stars</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><em>numpy.ndarray</em></a>) – Initial guess for stellar redshift for spaxel, if fitting a stellar template.         Added by <a class="reference internal" href="#q3dfit.q3din.q3din.init_contfit" title="q3dfit.q3din.q3din.init_contfit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">init_contfit()</span></code></a>.</p></li>
<li><p><strong>ncols</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of columns in data cube. Added by <a class="reference internal" href="#q3dfit.q3din.q3din.load_cube" title="q3dfit.q3din.q3din.load_cube"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_cube()</span></code></a>.</p></li>
<li><p><strong>nrows</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of rows in data cube. Added by <a class="reference internal" href="#q3dfit.q3din.q3din.load_cube" title="q3dfit.q3din.q3din.load_cube"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_cube()</span></code></a>.</p></li>
<li><p><strong>cubedim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Dimension of data cube. Added by <a class="reference internal" href="#q3dfit.q3din.q3din.load_cube" title="q3dfit.q3din.q3din.load_cube"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_cube()</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="q3dfit.q3din.q3din.init_linefit">
<span class="sig-name descname"><span class="pre">init_linefit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lines</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linetie</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxncomp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">siginit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">siglim_gas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[5.0,</span> <span class="pre">2000.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zinit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcnlineinit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lineinit'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">argslineinit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">argslinelist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">argslinefit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkcomp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcncheckcomp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'checkcomp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">argscheckcomp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perror_useresid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perror_errspecwin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perror_residwin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/q3din.html#q3din.init_linefit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.q3din.q3din.init_linefit" title="Link to this definition"></a></dt>
<dd><p>Initialize line fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lines</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span>) – Lines to fit.</p></li>
<li><p><strong>linetie</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>) – Optional on input. As input:
1. Set to None to fit all lines independently.
2. Set to a single line to tie all lines together.
3. Set to a list of strings to tie lines in groups.
Default is None.</p></li>
<li><p><strong>maxncomp</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Optional. Maximum possible number of velocity components in any line.
Default is 1. Also sets the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">maxncomp</span></code>.</p></li>
<li><p><strong>siginit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Optional. Uniform initial guess for emission-line velocity dispersion in km/s.
Default is 50. This can be overridden by setting <code class="xref py py-attr docutils literal notranslate"><span class="pre">siginit_gas</span></code>
for individual lines, spaxels, and components after initialization.</p></li>
<li><p><strong>siglim_gas</strong> (<span class="sphinx_autodoc_typehints-type">ArrayLike</span>) – Optional. Lower and upper limits for sigma in km/s for each line, spaxel,
and component. Default is [5., 2000.]. This can be overridden by setting
<code class="xref py py-attr docutils literal notranslate"><span class="pre">siglim_gas</span></code> for individual lines, spaxels,
and components after initialization.</p></li>
<li><p><strong>zinit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</span>) – Optional. Initial redshift in km/s to apply to each line. If zinit
is None, try to use <code class="xref py py-attr docutils literal notranslate"><span class="pre">zsys_gas</span></code>. Default is None.
This can be overridden by setting <code class="xref py py-attr docutils literal notranslate"><span class="pre">zinit_gas</span></code> for
individual lines, spaxels, and components after initialization.</p></li>
<li><p><strong>fcnlineinit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Optional. Name of routine to initialize line fit. Default is ‘lineinit’.
Also sets the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">fcnlineinit</span></code>.</p></li>
<li><p><strong>argslineinit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></span>) – Optional. Arguments for the line initialization function
fcnlineinit. Default is an empty dict. Also sets the attribute
<code class="xref py py-attr docutils literal notranslate"><span class="pre">argslineinit</span></code>.</p></li>
<li><p><strong>argslinelist</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></span>) – Optional. Arguments for <a class="reference internal" href="#q3dfit.linelist.linelist" title="q3dfit.linelist.linelist"><code class="xref py py-func docutils literal notranslate"><span class="pre">linelist()</span></code></a>.
Default is an empty dict. Also sets the attribute
<code class="xref py py-attr docutils literal notranslate"><span class="pre">argslinelist</span></code>.</p></li>
<li><p><strong>argslinefit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></span>) – Optional. Arguments for <code class="xref py py-func docutils literal notranslate"><span class="pre">fit()</span></code> or
to the fitting method selected. Default is an empty dict.
Also sets the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">argslinefit</span></code>.
Available arguments for
<code class="xref py py-func docutils literal notranslate"><span class="pre">fit()</span></code> are ‘method’, ‘max_nfev’, and ‘iter_cb’,
which can be passed as key/value pairs. If ‘method’ is not set, it
defaults to ‘least_squares’. If the key ‘max_nfev’ is not set, it
defaults to 200*(Nfitpars+1). If the key ‘iter_cb’ is not set, it
defaults to None. Any other key/value pairs are passed as
arguments to the fitting function through the ‘fit_kws’ argument
to <code class="xref py py-func docutils literal notranslate"><span class="pre">fit()</span></code>.</p></li>
<li><p><strong>checkcomp</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. If True, reject components using
<a class="reference internal" href="#q3dfit.checkcomp.checkcomp" title="q3dfit.checkcomp.checkcomp"><code class="xref py py-func docutils literal notranslate"><span class="pre">checkcomp()</span></code></a>. Default is True.
Also sets the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">checkcomp</span></code>.</p></li>
<li><p><strong>fcncheckcomp</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Optional. Name of routine for component rejection. Default is
‘checkcomp’. Also sets the attribute
<code class="xref py py-attr docutils literal notranslate"><span class="pre">fcncheckcomp</span></code>.</p></li>
<li><p><strong>argscheckcomp</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></span>) – Optional. Arguments for the component rejection function fcncheckcomp.
Default is an empty dict. Also sets the attribute
<code class="xref py py-attr docutils literal notranslate"><span class="pre">argscheckcomp</span></code>.</p></li>
<li><p><strong>perror_errspecwin</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Optional. Parameter for calculating the error on the flux peak using
the median of the error spectrum in a window of this width in pixels,
centered on the best-fit peak. Default is 20 pixels.
Also sets the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">perror_errspecwin</span></code>.</p></li>
<li><p><strong>perror_residwin</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Optional. Parameter for calculating the error on the flux peak using
the standard deviation of the fit residuals in a window of this width
centered on the best-fit peak. Default is 200 pixels. Also sets the
attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">perror_residwin</span></code>.</p></li>
<li><p><strong>perror_useresid</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. If True, use the flux peak error calculated from the residuals
as the error on the flux peak if it is greater than the flux peak
error calculated by <code class="xref py py-func docutils literal notranslate"><span class="pre">fit()</span></code>. Default is False.
Useful if the error spectrum is not reliable. Also sets the attribute
<code class="xref py py-attr docutils literal notranslate"><span class="pre">perror_useresid</span></code>.</p></li>
<li><p><strong>quiet</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Suppress messages. Default is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="q3dfit.q3din.q3din.init_contfit">
<span class="sig-name descname"><span class="pre">init_contfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcncontfit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">argscontfit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">siginit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zinit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dividecont</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ebv_star</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepstarz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskwidths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskwidths_def</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masksig_secondfit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nolinemask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nomaskran</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">startempfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">startempvac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decompose_qso_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decompose_ppxf_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/q3din.html#q3din.init_contfit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.q3din.q3din.init_contfit" title="Link to this definition"></a></dt>
<dd><p>Initialize continuum fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fcncontfit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Function to fit continuum. Assumed to be a function in
<a class="reference internal" href="#module-q3dfit.contfit" title="q3dfit.contfit"><code class="xref py py-mod docutils literal notranslate"><span class="pre">q3dfit.contfit</span></code></a>. Exception is <code class="xref py py-mod docutils literal notranslate"><span class="pre">ppxf.ppxf</span></code>,
for which one can specify ‘ppxf’. Also sets the attribute
<code class="xref py py-attr docutils literal notranslate"><span class="pre">fcncontfit</span></code>.</p></li>
<li><p><strong>argscontfit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></span>) – Optional. Arguments for the continuum fitting function fcncontfit.
Default is an empty dict. Also sets the attribute
<code class="xref py py-attr docutils literal notranslate"><span class="pre">argscontfit</span></code>.</p></li>
<li><p><strong>siginit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Optional. Uniform initial guess for stellar velocity dispersion in km/s,
if fitting a stellar template. Default is 50. This can be overridden by
setting <code class="xref py py-attr docutils literal notranslate"><span class="pre">siginit_stars</span></code> for individual
spaxels after initialization.</p></li>
<li><p><strong>zinit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</span>) – Optional. Initial redshift for stellar template, if fitting one. If zinit
is None, try to use <code class="xref py py-attr docutils literal notranslate"><span class="pre">zsys_gas</span></code>. Default is None.
This can be overridden by setting <code class="xref py py-attr docutils literal notranslate"><span class="pre">zinit_stars</span></code> for
individual spaxels after initialization.</p></li>
<li><p><strong>dividecont</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Divide data by continuum fit. Default is to subtract.
Also sets the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">dividecont</span></code>.</p></li>
<li><p><strong>ebv_star</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</span>) – Optional. Initial guess for E(B-V) for stellar template fitting in
<code class="xref py py-func docutils literal notranslate"><span class="pre">ppxf()</span></code>. Default is None, which means no extinction
is applied. Also sets the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">ebv_star</span></code>.</p></li>
<li><p><strong>keepstarz</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. If True, don’t redshift stellar template before fitting. Default
is False. Also sets the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">keepstarz</span></code>.</p></li>
<li><p><strong>maskwidths</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.table.Table.html#astropy.table.Table" title="(in Astropy v6.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>) – Optional. Prior to the first continuum fit in <a class="reference internal" href="#q3dfit.fitloop.fitloop" title="q3dfit.fitloop.fitloop"><code class="xref py py-func docutils literal notranslate"><span class="pre">fitloop()</span></code></a>,
mask these half-widths, in km/s, around the emission lines to be fit.
To use this option, specify a value for each line and component.
If set to None and both continuum and emission-line fits are attempted,
routine defaults to uniform value set by maskwidths_def. Default is None.
Also sets the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">maskwidths</span></code>.</p></li>
<li><p><strong>maskwidths_def</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Optional. Prior to the first continuum fit in <a class="reference internal" href="#q3dfit.fitloop.fitloop" title="q3dfit.fitloop.fitloop"><code class="xref py py-func docutils literal notranslate"><span class="pre">fitloop()</span></code></a>,
mask this uniform half-width, in km/s, around each emission line to be fit.
Default is 500. Also sets the attribute
<code class="xref py py-attr docutils literal notranslate"><span class="pre">maskwidths_def</span></code>.</p></li>
<li><p><strong>masksig_secondfit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Optional. When computing half-widths for masking before the second fit
in <a class="reference internal" href="#q3dfit.fitloop.fitloop" title="q3dfit.fitloop.fitloop"><code class="xref py py-func docutils literal notranslate"><span class="pre">fitloop()</span></code></a>, best-fit sigmas from the
first fit are multiplied by this number. Default is 2.</p></li>
<li><p><strong>nolinemask</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. If True, don’t mask emission lines before continuum fit. Default
is False. Also sets the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">nolinemask</span></code>.</p></li>
<li><p><strong>nomaskran</strong> (<span class="sphinx_autodoc_typehints-type">ArrayLike</span>) – Optional. ArrayLike with 2 x nreg dimensions. Set of lower and upper
wavelength limits of regions not to mask. Default is None.
Also sets the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">nomaskran</span></code>.</p></li>
<li><p><strong>startempfile</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span>) – Optional. Name of numpy save file containing stellar templates. Default is None.
Also sets the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">startempfile</span></code>. Must
be set for stellar template fitting to work. Save file must contain a
dictionary with keys ‘wave’ and ‘flux’. ‘wave’ is a 1d numpy array. ‘flux’
is a 2d array, with the second dimension being the number of templates.
If the stellar template is not in vacuum wavelengths, set
<code class="xref py py-attr docutils literal notranslate"><span class="pre">startempvac</span></code> to False.</p></li>
<li><p><strong>startempvac</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Is the stellar template in vacuum wavelengths? If True and the
data are in air wavelengths, the template is converted to air wavelengths
in <a class="reference internal" href="#q3dfit.fitspec.fitspec" title="q3dfit.fitspec.fitspec"><code class="xref py py-func docutils literal notranslate"><span class="pre">fitspec()</span></code></a>. Default is True. Also sets the attribute
<code class="xref py py-attr docutils literal notranslate"><span class="pre">startempvac</span></code>.</p></li>
<li><p><strong>quiet</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Suppress messages. Default is False.</p></li>
<li><p><strong>tweakcntfit</strong> – Optional. Tweak the continuum fit using local polynomial fitting.
Default is None. (Not yet implemented.)</p></li>
<li><p><strong>fcnconvtemp</strong> – Optional. Function with which to convolve template before fitting.
Default is None. (Not yet implemented.)</p></li>
<li><p><strong>argsconvtemp</strong> – Optional. Arguments for the template convolution function fcnconvtemp.
Default is an empty dict. (Not yet implemented.)</p></li>
<li><p><strong>decompose_qso_fit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Decompose QSO fit when running
<code class="xref py py-meth docutils literal notranslate"><span class="pre">sepcontpars()</span></code>. Default is False.</p></li>
<li><p><strong>decompose_ppxf_fit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Decompose pPXF fit when running
<code class="xref py py-meth docutils literal notranslate"><span class="pre">sepcontpars()</span></code>. Default is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="q3dfit.q3din.q3din.load_cube">
<span class="sig-name descname"><span class="pre">load_cube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/q3din.html#q3din.load_cube"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.q3din.q3din.load_cube" title="Link to this definition"></a></dt>
<dd><p>Load data cube from file. Instantiates <a class="reference internal" href="#q3dfit.readcube.Cube" title="q3dfit.readcube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>quiet</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Suppress Cube.about(). Default is False.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#q3dfit.readcube.Cube" title="q3dfit.readcube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>readcube.Cube</em> – <a class="reference internal" href="#q3dfit.readcube.Cube" title="q3dfit.readcube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a> object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="q3dfit.q3din.q3din.get_dispersion">
<span class="sig-name descname"><span class="pre">get_dispersion</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/q3din.html#q3din.get_dispersion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.q3din.q3din.get_dispersion" title="Link to this definition"></a></dt>
<dd><p>Instantiate <code class="xref py py-class docutils literal notranslate"><span class="pre">spectConvol</span></code> object with dispersion
information for selected gratings.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">spectConvol</span></code>]</span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Optional[spectConvol.spectConvol]</em> – <code class="xref py py-class docutils literal notranslate"><span class="pre">spectConvol</span></code> object, or None (no convolution) if
q3di.spect_convol is an empty dictionary.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="q3dfit.q3din.q3din.get_linelist">
<span class="sig-name descname"><span class="pre">get_linelist</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/q3din.html#q3din.get_linelist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.q3din.q3din.get_linelist" title="Link to this definition"></a></dt>
<dd><p>Get parameters of emission lines to be fit from internal database.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.table.Table.html#astropy.table.Table" title="(in Astropy v6.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a></span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Table | list</em> – Return output of py:func:<cite>~q3dfit.linelist.linelist</cite> as a Table if
q3di has attribute lines (i.e., initializes an emission-line fit),
or as an empty list if not.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="internal-modules">
<h1>Internal modules<a class="headerlink" href="#internal-modules" title="Link to this heading"></a></h1>
<section id="module-q3dfit.checkcomp">
<span id="checkcomp"></span><h2>checkcomp<a class="headerlink" href="#module-q3dfit.checkcomp" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.checkcomp.checkcomp">
<span class="sig-prename descclassname"><span class="pre">q3dfit.checkcomp.</span></span><span class="sig-name descname"><span class="pre">checkcomp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">linepars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linetie</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncomp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">siglim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigcut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/checkcomp.html#checkcomp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.checkcomp.checkcomp" title="Link to this definition"></a></dt>
<dd><p>Automatically search for “good” components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>linepars</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span>) – <code class="xref py py-attr docutils literal notranslate"><span class="pre">line_fitpars</span></code> attribute of
<code class="xref py py-class docutils literal notranslate"><span class="pre">q3dout</span></code></p></li>
<li><p><strong>linetie</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span>) – <code class="xref py py-attr docutils literal notranslate"><span class="pre">linetie</span></code> attribute of
<a class="reference internal" href="#q3dfit.q3din.q3din" title="q3dfit.q3din.q3din"><code class="xref py py-class docutils literal notranslate"><span class="pre">q3din</span></code></a></p></li>
<li><p><strong>ncomp</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – # of components for each fitted line.</p></li>
<li><p><strong>siglim</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]</span>) – Sigma limits for emission lines.</p></li>
<li><p><strong>sigcut</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Optional. Sigma threshold in flux for rejection of a component.
Default is 3.</p></li>
<li><p><strong>subone</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. If True, remove only one component if multiple lines are found to be
insignificant. Useful when degeneracy between components
lowers significance for all components, but some components
still exist. Default is False.</p></li>
<li><p><strong>ignore</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span>) – Optional. Array of lines to ignore in looking for good copmonents,
array of string-typed elements. Default is empty list.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>dict[str, int]</em> – # of good components for each unique linetie anchor. The input ncomp is also
updated to reflect correct new # of components.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-q3dfit.fitloop">
<span id="fitloop"></span><h2>fitloop<a class="headerlink" href="#module-q3dfit.fitloop" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.fitloop.fitloop">
<span class="sig-prename descclassname"><span class="pre">q3dfit.fitloop.</span></span><span class="sig-name descname"><span class="pre">fitloop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ispax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colarr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rowarr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cube</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q3di</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">listlines</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specConv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onefit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/fitloop.html#fitloop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.fitloop.fitloop" title="Link to this definition"></a></dt>
<dd><p>Perform fitting loops over spaxels. This function calls
<a class="reference internal" href="#q3dfit.fitspec.fitspec" title="q3dfit.fitspec.fitspec"><code class="xref py py-func docutils literal notranslate"><span class="pre">fitspec()</span></code></a> to fit the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ispax</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Value of index over which to loop.</p></li>
<li><p><strong>colarr</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Array of column #s of spaxels to be fit (0-offset).</p></li>
<li><p><strong>rowarr</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Array of row #s of spaxels to be fit (0-offset).</p></li>
<li><p><strong>cube</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#q3dfit.readcube.Cube" title="q3dfit.readcube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a></span>) – <a class="reference internal" href="#q3dfit.readcube.Cube" title="q3dfit.readcube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a> object containing data to be fit.</p></li>
<li><p><strong>q3di</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#q3dfit.q3din.q3din" title="q3dfit.q3din.q3din"><code class="xref py py-class docutils literal notranslate"><span class="pre">q3din</span></code></a></span>) – <a class="reference internal" href="#q3dfit.q3din.q3din" title="q3dfit.q3din.q3din"><code class="xref py py-class docutils literal notranslate"><span class="pre">q3din</span></code></a> object containing fitting parameters.</p></li>
<li><p><strong>listlines</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.table.Table.html#astropy.table.Table" title="(in Astropy v6.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a></span>) – Emission line labels and rest frame wavelengths, as part of an astropy Table
output by <a class="reference internal" href="#q3dfit.linelist.linelist" title="q3dfit.linelist.linelist"><code class="xref py py-func docutils literal notranslate"><span class="pre">linelist()</span></code></a>.</p></li>
<li><p><strong>specConv</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">spectConvol</span></code>]</span>) – Instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">spectConvol</span></code> specifying
the instrumental spectral resolution convolution. If None, no convolution
is performed.</p></li>
<li><p><strong>onefit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – If set, only one fit is performed. Default is False.</p></li>
<li><p><strong>quiet</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Suppress progress messages. Default is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-q3dfit.fitspec">
<span id="fitspec"></span><h2>fitspec<a class="headerlink" href="#module-q3dfit.fitspec" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.fitspec.fitspec">
<span class="sig-prename descclassname"><span class="pre">q3dfit.fitspec.</span></span><span class="sig-name descname"><span class="pre">fitspec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wlambda</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q3di</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zstar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">listlines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">listlinesz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncomp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linevary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskwidths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peakinit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">siginit_gas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">siginit_stars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">siglim_gas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specConv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">waveunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/fitspec.html#fitspec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.fitspec.fitspec" title="Link to this definition"></a></dt>
<dd><p>This function is the core routine to fit the continuum and emission
lines of a spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wlambda</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Spectrum, observed-frame wavelengths.</p></li>
<li><p><strong>flux</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Spectrum, fluxes.</p></li>
<li><p><strong>err</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Spectrum, flux errors.</p></li>
<li><p><strong>q3di</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#q3dfit.q3din.q3din" title="q3dfit.q3din.q3din"><code class="xref py py-class docutils literal notranslate"><span class="pre">q3din</span></code></a></span>) – Instance of <a class="reference internal" href="#q3dfit.q3din.q3din" title="q3dfit.q3din.q3din"><code class="xref py py-class docutils literal notranslate"><span class="pre">q3din</span></code></a> initializing the fit.</p></li>
<li><p><strong>zstar</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</span>) – Optional. Initial guess for stellar redshift. Use None if no continuum
fit is done.</p></li>
<li><p><strong>siginit_stars</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</span>) – Optional. Initial guess for stellar line widths for fitting. It is created
by <code class="xref py py-func docutils literal notranslate"><span class="pre">init_contfit()</span></code> or specified on input. Set to None
if no continuum fit is done.</p></li>
<li><p><strong>listlines</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.table.Table.html#astropy.table.Table" title="(in Astropy v6.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a>]</span>) – Optional. Emission line labels and rest frame wavelengths, as part of an astropy
Table output by <a class="reference internal" href="#q3dfit.linelist.linelist" title="q3dfit.linelist.linelist"><code class="xref py py-func docutils literal notranslate"><span class="pre">linelist()</span></code></a>. Use None if no emission-line
fit is done.</p></li>
<li><p><strong>listlinesz</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]]</span>) – Optional. Initial guess for emission line observed frame wavelengths. Use
None if no emission-line fit is done.</p></li>
<li><p><strong>ncomp</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]</span>) – Optional. Number of components fit to each line. Use None if no emission-line
fit is done.</p></li>
<li><p><strong>linevary</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]]]</span>) – Optional. Dictionary specifying which parameters to vary for each line.
Nested dictionary with line names as keys, and dictionaries as values.
These dictionaries have keys ‘flx’, ‘cen’, and ‘sig’, with boolean arrays
as values. Default is None, which if emission-line fit is done,
means varying all parameters.</p></li>
<li><p><strong>maskwidths</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.table.Table.html#astropy.table.Table" title="(in Astropy v6.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>) – Optional. Widths, in km/s, of emission-line regions to mask from continuum fit.
If set to None, routine will look for <cite>maskwidths</cite> attribute in
<a class="reference internal" href="#q3dfit.q3din.q3din" title="q3dfit.q3din.q3din"><code class="xref py py-class docutils literal notranslate"><span class="pre">q3din</span></code></a>. If this is None and both continuum and emission-
line fits are attempted, routine defaults to value
set in <cite>maskwidths_def</cite> attribute of <a class="reference internal" href="#q3dfit.q3din.q3din" title="q3dfit.q3din.q3din"><code class="xref py py-class docutils literal notranslate"><span class="pre">q3din</span></code></a>.</p></li>
<li><p><strong>peakinit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.table.Table.html#astropy.table.Table" title="(in Astropy v6.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>) – Optional. Initial guess for peak emission-line flux densities. If set to
None, routine will look for <cite>peakinit</cite> attribute in
<a class="reference internal" href="#q3dfit.q3din.q3din" title="q3dfit.q3din.q3din"><code class="xref py py-class docutils literal notranslate"><span class="pre">q3din</span></code></a>. If this is None and line fit is done,
routine estimates from data.</p></li>
<li><p><strong>siginit_gas</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]]</span>) – Optional. Initial guess for emission line widths for fitting. It is created
by <code class="xref py py-func docutils literal notranslate"><span class="pre">init_linefit()</span></code> or specified on input. Set to None
if no emission-line fit is done.</p></li>
<li><p><strong>siglim_gas</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]]</span>) – Optional. Sigma limits for line fitting. It is created by
<code class="xref py py-func docutils literal notranslate"><span class="pre">init_linefit()</span></code> or specified on input. Set to None
if no emission-line fit is done.</p></li>
<li><p><strong>specConv</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">spectConvol</span></code>]</span>) – Optional. Instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">spectConvol</span></code> specifying
the instrumental spectral resolution convolution. If None, no convolution
is done.</p></li>
<li><p><strong>fluxunit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span>) – Optional. Units of flux density defined in <a class="reference internal" href="#q3dfit.readcube.Cube" title="q3dfit.readcube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a>.
Default is None.</p></li>
<li><p><strong>waveunit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span>) – Optional. Units of wavelength defined in <a class="reference internal" href="#q3dfit.readcube.Cube" title="q3dfit.readcube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a>.
Default is None.</p></li>
<li><p><strong>quiet</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. If False, some progress messages are written to stdout.
Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">q3dout</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>q3dout.q3dout</em> – Instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">q3dout</span></code> containing the fit results.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.fitspec.per_iteration">
<span class="sig-prename descclassname"><span class="pre">q3dfit.fitspec.</span></span><span class="sig-name descname"><span class="pre">per_iteration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resid</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kws</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/fitspec.html#per_iteration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.fitspec.per_iteration" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.fitspec.airtovac">
<span class="sig-prename descclassname"><span class="pre">q3dfit.fitspec.</span></span><span class="sig-name descname"><span class="pre">airtovac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">waveunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Angstrom'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/fitspec.html#airtovac"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.fitspec.airtovac" title="Link to this definition"></a></dt>
<dd><p>Takes an array of wavelengths in air and converts them to vacuum
using eq. 3 from Morton et al. 1991 ApJSS 77 119</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wv</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Input wavelengths.</p></li>
<li><p><strong>waveunit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'micron'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Angstrom'</span></code>]</span>) – Optional. Wavelength unit. Default is Angstrom.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>ndarray</em> – An array of the same dimensions as the input and in the same units
as the input</p>
</dd>
</dl>
<p class="rubric">References</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wv</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3000</span><span class="p">,</span><span class="mi">7000</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vac_wv</span><span class="o">=</span><span class="n">airtovac</span><span class="p">(</span><span class="n">wv</span><span class="p">)</span>
<span class="go">array([3000.87467224, 3001.87492143, 3002.87517064, ..., 6998.92971915, 6999.92998844, 7000.93025774])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.fitspec.masklin">
<span class="sig-prename descclassname"><span class="pre">q3dfit.fitspec.</span></span><span class="sig-name descname"><span class="pre">masklin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">llambda</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linelambda</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halfwidth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nomaskran</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/fitspec.html#masklin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.fitspec.masklin" title="Link to this definition"></a></dt>
<dd><p>Masks emission lines from the spectrum for continuum fitting</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>llambda</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Wavelengths of the spectrum.</p></li>
<li><p><strong>linelambda</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]</span>) – Dictionary with line names as keys and arrays of central wavelengths as values,
one value per component.</p></li>
<li><p><strong>halfwidth</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.table.Table.html#astropy.table.Table" title="(in Astropy v6.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a></span>) – Dictionary with line names as keys and arrays of half widths as values, one
value per component; or a Table with the same structure.</p></li>
<li><p><strong>nomaskran</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[ArrayLike]</span>) – Optional. Set of lower and upper wavelength limits of regions not to mask. If
None, no regions are excluded.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>numpy.ndarray</em> – Array of llambda-array indices indicating non-masked wavelengths.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic">
<li><p>from masklin import masklin</p>
<p>Generate linelist:</p>
<p>from linelist import linelist
mylist=[‘Halpha’,’Hbeta’,’Hgamma’]
u=linelist(inlines=mylist)</p>
<p>Generate wavelength array:</p>
<p>import numpy as np
llambda=np.arange(3000.,8000.,1.)</p>
<p>Generate half widths for masking:
from astropy.table import Table
# <a class="reference external" href="https://docs.astropy.org/en/stable/table/construct_table.html">https://docs.astropy.org/en/stable/table/construct_table.html</a>
halfwidth=Table([u[‘name’]])
# populate another column
# <a class="reference external" href="https://docs.astropy.org/en/stable/table/modify_table.html">https://docs.astropy.org/en/stable/table/modify_table.html</a>
halfwidth[‘halfwidths’]=6000.0
# I have chosen a huge masking width for better visual eff
#now use the masking function
ind=masklin(llambda, u, halfwidth, 60.)</p>
</li>
</ol>
<p># plot the spectrum without and with the masking
from matplotlib import pyplot as plt
plt.interactive(True)
fig=plt.figure(1, figsize=(8,8))
plt.clf()
spec=1.+(llambda-3000.0)*1e-3
plt.plot(llambda, spec, color=’grey’,alpha=0.3)
plt.scatter(llambda[ind],spec[ind]+0.05,color=’red’,alpha=0.1,s=2)
plt.show()</p>
<p># now let’s define a no-masking array
dontmask=np.array([[3000,4000,5000],[4000,5000,6000]])
ind1=masklin(llambda, u, halfwidth, 60., nomaskran=dontmask)
plt.scatter(llambda[ind1],spec[ind1]-0.05,color=’blue’,alpha=0.03,s=2)
plt.show()</p>
</dd></dl>

</section>
<section id="module-q3dfit.lineinit">
<span id="lineinit"></span><h2>lineinit<a class="headerlink" href="#module-q3dfit.lineinit" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.lineinit.lineinit">
<span class="sig-prename descclassname"><span class="pre">q3dfit.lineinit.</span></span><span class="sig-name descname"><span class="pre">lineinit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">linelist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linelistz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linetie</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linevary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initflux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initsig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">siglim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncomp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specConv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">waves</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/lineinit.html#lineinit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.lineinit.lineinit" title="Link to this definition"></a></dt>
<dd><p>Initialize parameters for emission-line fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>linelist</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.table.Table.html#astropy.table.Table" title="(in Astropy v6.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a></span>) – Emission lines to fit.</p></li>
<li><p><strong>linelistz</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></span>) – Initial guess for line redshifts.</p></li>
<li><p><strong>linetie</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></span>) – Line to which to tie each line.</p></li>
<li><p><strong>linevary</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]</span>) – Line parameter vary flags (fix/free).</p></li>
<li><p><strong>initflux</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]</span>) – Initial guess for line fluxes.</p></li>
<li><p><strong>initsig</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]</span>) – Initial guess for line sigmas.</p></li>
<li><p><strong>siglim</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]</span>) – Lower and upper limits for line sigmas.</p></li>
<li><p><strong>ncomp</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]</span>) – Number of components for each line.</p></li>
<li><p><strong>specConv</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">spectConvol</span></code>]</span>) – Optional. Spectral resolution object. If set to None, no convolution
will be performed. The default is None.</p></li>
<li><p><strong>lineratio</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.table.Table.html#astropy.table.Table" title="(in Astropy v6.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a>, <a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.table.QTable.html#astropy.table.QTable" title="(in Astropy v6.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QTable</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>) – Optional. Table of line ratio constraints, beyond those in the doublets table.
The default is None.</p></li>
<li><p><strong>waves</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]</span>) – Optional. Wavelength array for determining if a line is in the fit range.
The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>lmfit.Model</em></p></li>
<li><p><em>lmfit.Parameters</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.lineinit.set_params">
<span class="sig-prename descclassname"><span class="pre">q3dfit.lineinit.</span></span><span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NAME</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">VALUE</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">VARY</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LIMITED</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TIED</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LIMITS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/lineinit.html#set_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.lineinit.set_params" title="Link to this definition"></a></dt>
<dd><p>Set parameters for the lmfit model using the lmfit Parameters object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fit_params</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html#lmfit.parameter.Parameters" title="(in lmfit v1.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a></span>) – Fit parameter object.</p></li>
<li><p><strong>NAME</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Parameter name.</p></li>
<li><p><strong>VALUE</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</span>) – Optional. Initial value. The default is None, in which case no value is set.</p></li>
<li><p><strong>VARY</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Vary flag. The default is True, in which case the parameter is free to vary.</p></li>
<li><p><strong>LIMITED</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]</span>) – Whether or not to limit the parameter. The default, None, is to set no limits.</p></li>
<li><p><strong>TIED</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span>) – Expression for tying the parameter to another. The default is None.</p></li>
<li><p><strong>LIMITS</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]</span>) – Limits for the parameter. The default is None, in which case no limits are set.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html#lmfit.parameter.Parameters" title="(in lmfit v1.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Parameters</em> – Modified fit parameter object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.lineinit.manygauss">
<span class="sig-prename descclassname"><span class="pre">q3dfit.lineinit.</span></span><span class="sig-name descname"><span class="pre">manygauss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cwv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SPECRES</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/lineinit.html#manygauss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.lineinit.manygauss" title="Link to this definition"></a></dt>
<dd><p>Generate a Gaussian model for a given set of parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Wavelength array.</p></li>
<li><p><strong>flx</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Flux array.</p></li>
<li><p><strong>cwv</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Central wavelength.</p></li>
<li><p><strong>sig</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Sigma.</p></li>
<li><p><strong>SPECRES</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">spectConvol</span></code>]</span>) – Spectral resolution object, for convolving the Gaussian with the spectral
resolution. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>numpy.ndarray</em> – Gaussian model.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-q3dfit.linelist">
<span id="linelist"></span><h2>linelist<a class="headerlink" href="#module-q3dfit.linelist" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.linelist.linelist">
<span class="sig-prename descclassname"><span class="pre">q3dfit.linelist.</span></span><span class="sig-name descname"><span class="pre">linelist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inlines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linelab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">waveunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'micron'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vacuum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/linelist.html#linelist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.linelist.linelist" title="Link to this definition"></a></dt>
<dd><p>Generates an astropy Table of lines from the master files provided in
/data/linelist. No required parameters; by default the entire tables are read from
the linelist_air.tbl and linelist_vac.tbl, recomputed into vacuum and returned</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inlines</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>]</span>) – Optional. A list of strings to match against the ‘name’ part of the
master list to return only the lines requested. Default is None, which returns all
lines in the master list.</p></li>
<li><p><strong>linelab</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Whether to return the Tex-friendly labels for the lines. Default is True.</p></li>
<li><p><strong>vacuum</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Whether to return wavelengths in vacuum (returns air wavelengths if false);
conversion is equation 3 from Morton et al. 1991 ApJSS 77 119. Default is True.</p></li>
<li><p><strong>waveunit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'micron'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Angstrom'</span></code>]</span>) – Optional. Output wavelength unit of ‘Angstrom’ or ‘micron’. Default is ‘micron’.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.table.Table.html#astropy.table.Table" title="(in Astropy v6.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Table</em> – Columns ‘name’, ‘linelab’, ‘lines’. ‘name’ is the name of the line,
‘linelab’ is the LaTeX-friendly label, and ‘lines’ is the central
wavelength in the units requested.
Example: ‘Lyalpha’, ‘Ly$alpha$’, 1215.67</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To get the central wavelengths in microns of all lines in Table 2 of
Smith et al. 2007 ApJ 656 770 (PAHFIT paper) plus the high-ionization
[NeVI] line typical of AGN:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mylist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H2_00_S7&#39;</span><span class="p">,</span><span class="s1">&#39;H2_00_S6&#39;</span><span class="p">,</span><span class="s1">&#39;H2_00_S5&#39;</span><span class="p">,</span><span class="s1">&#39;[ArII]6.99&#39;</span><span class="p">,</span><span class="s1">&#39;[NeVI]7.65&#39;</span><span class="p">,</span><span class="s1">&#39;H2_00_S4&#39;</span><span class="p">,</span>
<span class="gp">... </span>       <span class="s1">&#39;[ArIII]8.99&#39;</span><span class="p">,</span><span class="s1">&#39;H2_00_S3&#39;</span><span class="p">,</span><span class="s1">&#39;[SIV]10.51&#39;</span><span class="p">,</span><span class="s1">&#39;H2_00_S2&#39;</span><span class="p">,</span><span class="s1">&#39;[NeII]12.81&#39;</span><span class="p">,</span>
<span class="gp">... </span>       <span class="s1">&#39;[NeIII]15.56&#39;</span><span class="p">,</span><span class="s1">&#39;H2_00_S1&#39;</span><span class="p">,</span><span class="s1">&#39;[SIII]18.71&#39;</span><span class="p">,</span><span class="s1">&#39;[OIV]25.89&#39;</span><span class="p">,</span><span class="s1">&#39;[FeII]25.99&#39;</span><span class="p">,</span>
<span class="gp">... </span>       <span class="s1">&#39;H2_00_S0&#39;</span><span class="p">,</span><span class="s1">&#39;[SIII]33.48&#39;</span><span class="p">,</span><span class="s1">&#39;[SiII]34.82&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">=</span><span class="n">linelist</span><span class="p">(</span><span class="n">mylist</span><span class="p">)</span>
</pre></div>
</div>
<p>To get the central wavelengths in microns of the strongest lines in
Storchi-Bergmann et al. 2009 MNRAS 394, 1148 (NIFS spectra of AGN):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mylist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Pae&#39;</span><span class="p">,</span><span class="s1">&#39;[SIII]0.9533&#39;</span><span class="p">,</span><span class="s1">&#39;HeII1.0126&#39;</span><span class="p">,</span><span class="s1">&#39;HeI1.0833&#39;</span><span class="p">,</span><span class="s1">&#39;Pag&#39;</span><span class="p">,</span> <span class="s1">&#39;[SIX]1.2524&#39;</span><span class="p">,</span>
<span class="gp">... </span>       <span class="s1">&#39;[FeII]1.2570&#39;</span><span class="p">,</span> <span class="s1">&#39;Pab&#39;</span><span class="p">,</span> <span class="s1">&#39;[FeII]1.6440&#39;</span><span class="p">,</span> <span class="s1">&#39;Br11&#39;</span><span class="p">,</span> <span class="s1">&#39;Br10&#39;</span><span class="p">,</span><span class="s1">&#39;Brg&#39;</span><span class="p">,</span>
<span class="gp">... </span>       <span class="s1">&#39;[SiVII]2.4833&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">=</span><span class="n">linelist</span><span class="p">(</span><span class="n">mylist</span><span class="p">)</span>
</pre></div>
</div>
<p>Will return all lines in the catalog with labels and central wavelengths
in vacuum in microns:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">=</span><span class="n">linelist</span><span class="p">()</span>
</pre></div>
</div>
<p>Will produce a table of vacuum wavelengths in microns for three lines
in the same order as given, and a warning there is a duplicated line
in mylist:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mylist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Paa&#39;</span><span class="p">,</span> <span class="s1">&#39;Halpha&#39;</span><span class="p">,</span> <span class="s1">&#39;Paa&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">=</span><span class="n">linelist</span><span class="p">(</span><span class="n">inlines</span><span class="o">=</span><span class="n">mylist</span><span class="p">)</span>
</pre></div>
</div>
<p>Will produce a table of air wavelengths in Angstroms for three lines, report
that line ‘junk’ is not in the line list, convert to air wavelengths and
to microns, complain that H2_00_S0 is outside the validity of the Morton’s
formula for vacuum to air conversion, and remove the line lables.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mylist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Paa&#39;</span><span class="p">,</span> <span class="s1">&#39;Halpha&#39;</span><span class="p">,</span> <span class="s1">&#39;junk&#39;</span><span class="p">,</span> <span class="s1">&#39;H2_00_S0&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">=</span><span class="n">linelist</span><span class="p">(</span><span class="n">inlines</span><span class="o">=</span><span class="n">mylist</span><span class="p">,</span><span class="n">vacuum</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">waveunit</span><span class="o">=</span><span class="s1">&#39;Angstrom&#39;</span><span class="p">,</span><span class="n">linelab</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>To get the central wavelength for an individual feature by name:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wv</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">linelist</span><span class="p">([</span><span class="s1">&#39;Halpha&#39;</span><span class="p">])[</span><span class="s1">&#39;lines&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>OR</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">=</span><span class="n">linelist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wv</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="s1">&#39;lines&#39;</span><span class="p">][(</span><span class="n">u</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Halpha&#39;</span><span class="p">)])</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-q3dfit.q3df_helperFunctions">
<span id="q3df-helperfunctions"></span><h2>q3df_helperFunctions<a class="headerlink" href="#module-q3dfit.q3df_helperFunctions" title="Link to this heading"></a></h2>
<p>Functions called by <a class="reference internal" href="#q3dfit.q3df.q3dfit" title="q3dfit.q3df.q3dfit"><code class="xref py py-mod docutils literal notranslate"><span class="pre">q3dfit</span></code></a> for single- and multi-threaded
execution.</p>
<p>If called externally (i.e., if we run q3df_helperFunctions.py from the command line),
this script will execute q3df_multiCore on multiple cores using MPI. This script
is called by <a class="reference internal" href="#q3dfit.q3df.q3dfit" title="q3dfit.q3df.q3dfit"><code class="xref py py-mod docutils literal notranslate"><span class="pre">q3dfit</span></code></a> when running in a multi-core environment.</p>
<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.q3df_helperFunctions.execute_fitloop">
<span class="sig-prename descclassname"><span class="pre">q3dfit.q3df_helperFunctions.</span></span><span class="sig-name descname"><span class="pre">execute_fitloop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nspax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colarr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rowarr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cube</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q3di</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linelist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specConv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onefit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">core</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nocrash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/q3df_helperFunctions.html#execute_fitloop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.q3df_helperFunctions.execute_fitloop" title="Link to this definition"></a></dt>
<dd><p>Handle the FITLOOP execution. In its own function due to commonality between
single- and multi-threaded execution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nspax</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Number of spaxels to be fitted.</p></li>
<li><p><strong>colarr</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – Array of column #s of spaxels to be fit (0-offset).</p></li>
<li><p><strong>rowarr</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – Array of row #s of spaxels to be fit (0-offset).</p></li>
<li><p><strong>cube</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#q3dfit.readcube.Cube" title="q3dfit.readcube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a></span>) – <a class="reference internal" href="#q3dfit.readcube.Cube" title="q3dfit.readcube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a> object containing data to be fit.</p></li>
<li><p><strong>q3di</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#q3dfit.q3din.q3din" title="q3dfit.q3din.q3din"><code class="xref py py-class docutils literal notranslate"><span class="pre">q3din</span></code></a></span>) – <a class="reference internal" href="#q3dfit.q3din.q3din" title="q3dfit.q3din.q3din"><code class="xref py py-class docutils literal notranslate"><span class="pre">q3din</span></code></a> object containing fitting parameters.</p></li>
<li><p><strong>linelist</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.table.Table.html#astropy.table.Table" title="(in Astropy v6.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a></span>) – Emission line labels and rest frame wavelengths, as part of an astropy Table
output by <a class="reference internal" href="#q3dfit.linelist.linelist" title="q3dfit.linelist.linelist"><code class="xref py py-func docutils literal notranslate"><span class="pre">linelist()</span></code></a>.</p></li>
<li><p><strong>specConv</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">spectConvol</span></code></span>) – Instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">spectConvol</span></code> specifying
the instrumental spectral resolution convolution.</p></li>
<li><p><strong>quiet</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – If False, progress messages are written to stdout.</p></li>
<li><p><strong>onefit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – If True, only one fit is performed.</p></li>
<li><p><strong>core</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Optional. Core number for multi-threaded execution. Default is 1.</p></li>
<li><p><strong>nocrash</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. If set, the routine will continue with the next spaxel in case
of a crash. Default is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.q3df_helperFunctions.q3df_oneCore">
<span class="sig-prename descclassname"><span class="pre">q3dfit.q3df_helperFunctions.</span></span><span class="sig-name descname"><span class="pre">q3df_oneCore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inobj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onefit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nocrash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/q3df_helperFunctions.html#q3df_oneCore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.q3df_helperFunctions.q3df_oneCore" title="Link to this definition"></a></dt>
<dd><p><a class="reference internal" href="#q3dfit.q3df.q3dfit" title="q3dfit.q3df.q3dfit"><code class="xref py py-func docutils literal notranslate"><span class="pre">q3dfit()</span></code></a> calls this function for single-threaded execution.
The parameters are passed through from <a class="reference internal" href="#q3dfit.q3df.q3dfit" title="q3dfit.q3df.q3dfit"><code class="xref py py-func docutils literal notranslate"><span class="pre">q3dfit()</span></code></a> and on
to <a class="reference internal" href="#q3dfit.fitloop.fitloop" title="q3dfit.fitloop.fitloop"><code class="xref py py-func docutils literal notranslate"><span class="pre">fitloop()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inobj</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | <a class="reference internal" href="#q3dfit.q3din.q3din" title="q3dfit.q3din.q3din"><code class="xref py py-class docutils literal notranslate"><span class="pre">q3din</span></code></a></span>) – Either a string with the path to the numpy save file containing the
input initialization object <a class="reference internal" href="#q3dfit.q3din.q3din" title="q3dfit.q3din.q3din"><code class="xref py py-class docutils literal notranslate"><span class="pre">q3din</span></code></a>,
or the object itself.</p></li>
<li><p><strong>cols</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>) – Optional. Column values for spaxels to be fitted. Default is None, which means
all columns will be fitted. If a scalar, only that column will be fitted. If a
2-element list or array, the elements are the starting and ending columns to be
fitted. Unity-offset values assumed.</p></li>
<li><p><strong>rows</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>) – Optional. Row values for spaxels to be fitted. Default is None, which means
all rows will be fitted. If a scalar, only that row will be fitted. If a
2-element list or array, the elements are the starting and ending rows to be
fitted. Unity-offset values assumed.</p></li>
<li><p><strong>onefit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. If set, only one fit is performed in <a class="reference internal" href="#q3dfit.fitloop.fitloop" title="q3dfit.fitloop.fitloop"><code class="xref py py-func docutils literal notranslate"><span class="pre">fitloop()</span></code></a>.
Default is False.</p></li>
<li><p><strong>quiet</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. If False, progress messages are written to stdout.
Default is True.</p></li>
<li><p><strong>nocrash</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. If set, the routine will continue with the next spaxel in case
of a crash. Default is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.q3df_helperFunctions.q3df_multiCore">
<span class="sig-prename descclassname"><span class="pre">q3dfit.q3df_helperFunctions.</span></span><span class="sig-name descname"><span class="pre">q3df_multiCore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inobj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onefit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/q3df_helperFunctions.html#q3df_multiCore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.q3df_helperFunctions.q3df_multiCore" title="Link to this definition"></a></dt>
<dd><p>Run <a class="reference internal" href="#q3dfit.fitloop.fitloop" title="q3dfit.fitloop.fitloop"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fitloop</span></code></a> on a single core in a multi-core environment.
This function is called by <a class="reference internal" href="#module-q3dfit.q3df_helperFunctions" title="q3dfit.q3df_helperFunctions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">q3df_helperFunctions</span></code></a> when run externally.
<a class="reference internal" href="#q3dfit.q3df.q3dfit" title="q3dfit.q3df.q3dfit"><code class="xref py py-func docutils literal notranslate"><span class="pre">q3dfit()</span></code></a> calls <a class="reference internal" href="#module-q3dfit.q3df_helperFunctions" title="q3dfit.q3df_helperFunctions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">q3df_helperFunctions</span></code></a>
externally when running in a multi-core environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rank</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Rank of this core for MPI execution.</p></li>
<li><p><strong>size</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Number of cores available for MPI execution.</p></li>
<li><p><strong>inobj</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | <a class="reference internal" href="#q3dfit.q3din.q3din" title="q3dfit.q3din.q3din"><code class="xref py py-class docutils literal notranslate"><span class="pre">q3din</span></code></a></span>) – Either a string with the path to the numpy save file containing the
input initialization object <a class="reference internal" href="#q3dfit.q3din.q3din" title="q3dfit.q3din.q3din"><code class="xref py py-class docutils literal notranslate"><span class="pre">q3din</span></code></a>,
or the object itself.</p></li>
<li><p><strong>cols</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]</span>) – Optional. Column values for spaxels to be fitted. If a single-element list, only that
column will be fitted. If a 2-element list, the elements are the starting and
ending columns to be fitted. Unity-offset values assumed. Default is None, which
means all columns will be fitted.</p></li>
<li><p><strong>rows</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]</span>) – Optional. Row values for spaxels to be fitted. If a single-element list, only that row
will be fitted. If a 2-element list, the elements are the starting and ending
rows to be fitted. Unity-offset values assumed. Default is None, which means
all rows will be fitted.</p></li>
<li><p><strong>onefit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. If True, only one fit is performed in <a class="reference internal" href="#q3dfit.fitloop.fitloop" title="q3dfit.fitloop.fitloop"><code class="xref py py-func docutils literal notranslate"><span class="pre">fitloop()</span></code></a>,
instead of two. Default is False.</p></li>
<li><p><strong>quiet</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. If False, progress messages are written to stdout. Default is True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.q3df_helperFunctions.string_to_intList">
<span class="sig-prename descclassname"><span class="pre">q3dfit.q3df_helperFunctions.</span></span><span class="sig-name descname"><span class="pre">string_to_intList</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strArray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/q3df_helperFunctions.html#string_to_intList"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.q3df_helperFunctions.string_to_intList" title="Link to this definition"></a></dt>
<dd><p>Convert a string of the form “[1, 2, 3, …]” to a list of integers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>strArray</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The string to be converted. The string is expected to be
a list of integers in square brackets, separated by commas; a
single integer; or a value starting with ‘N’ to indicate None.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>intList</em> – A list of integers, or None if the input string started with ‘N’.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-q3dfit.q3dmath">
<span id="q3dmath"></span><h2>q3dmath<a class="headerlink" href="#module-q3dfit.q3dmath" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.q3dmath.interptemp">
<span class="sig-prename descclassname"><span class="pre">q3dfit.q3dmath.</span></span><span class="sig-name descname"><span class="pre">interptemp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec_lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp_lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/q3dmath.html#interptemp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.q3dmath.interptemp" title="Link to this definition"></a></dt>
<dd><p>(Linearly) interpolate templates from template wavelength grid to data
wavelength grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec_lam</strong> (<span class="sphinx_autodoc_typehints-type">ArrayLike</span>) – Wavelengths of data arrays.</p></li>
<li><p><strong>temp_lam</strong> (<span class="sphinx_autodoc_typehints-type">ArrayLike</span>) – Wavelengths of template arrays.</p></li>
<li><p><strong>template</strong> (<span class="sphinx_autodoc_typehints-type">ArrayLike</span>) – Model fluxes from templates. Second dimension is the number of
templates.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type">ArrayLike</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>ArrayLike</em> – The interpolated templates.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.q3dmath.interp_lis">
<span class="sig-prename descclassname"><span class="pre">q3dfit.q3dmath.</span></span><span class="sig-name descname"><span class="pre">interp_lis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec_lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp_lam_lis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template_lis</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/q3dmath.html#interp_lis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.q3dmath.interp_lis" title="Link to this definition"></a></dt>
<dd><p>This function samples a single template or list of templates onto
the wavelength array of the input observed spectrum.  The output is
padded with NaN values instead of extrapolating beyond any template’s
wavelength range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec_lam</strong> (<span class="sphinx_autodoc_typehints-type">ArrayLike</span>) – reference wavelength array onto which the templates(s) are interpolated</p></li>
<li><p><strong>temp_lam_lis</strong> (<span class="sphinx_autodoc_typehints-type">list[ArrayLike] | ArrayLike</span>) – Template wavelength array or list containing the wavelength arrays of the
different templates (not required to be at same length). (Also accepts 1D list,
list containing a 1D array, or list of lists)</p></li>
<li><p><strong>template_lis</strong> (<span class="sphinx_autodoc_typehints-type">list[ArrayLike] | ArrayLike</span>) – Template flux array or list containing the flux arrays of the different templates
(not required to be at same length). (Also accepts 1D list, list containing a 1D
array, or list of lists)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type">np.ndarray</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>numpy.ndarray</em> – Array containing the flux of the templates interpolated onto the spec_lam input
array.
If 2D, the 2nd dimension corresponds to the flux arrays of individual templates,
i.e. the newly sampled flux of template 0 can be accessed as new_temp[:,0], while
for template 1 this is new_temp[:,1], etc. The new_temp array is padded with NaN
values where the wavelength range of the respective template was more narrow than
the observed spectum.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.q3dmath.cutoff_NaNs">
<span class="sig-prename descclassname"><span class="pre">q3dfit.q3dmath.</span></span><span class="sig-name descname"><span class="pre">cutoff_NaNs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec_lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_temp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/q3dmath.html#cutoff_NaNs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.q3dmath.cutoff_NaNs" title="Link to this definition"></a></dt>
<dd><p>This function removes any NaN values from the output of the interp_lis() function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec_lam</strong> (<span class="sphinx_autodoc_typehints-type">ArrayLike</span>) – reference wavelength array onto which the templates(s) are interpolated</p></li>
<li><p><strong>new_temp</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – 1D or 2D array with newly interpolated template fluxes, corresponding to the
output of interp_lis()</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[ArrayLike, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>new_temp_NoNan</em> – Same as new_temp, but without any NaN elements / rows containing at least one NaN
value</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-q3dfit.q3dutil">
<span id="q3dutil"></span><h2>q3dutil<a class="headerlink" href="#module-q3dfit.q3dutil" title="Link to this heading"></a></h2>
<p>Utility functions that are used by multiple modules in the q3dfit package.</p>
<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.q3dutil.get_q3dio">
<span class="sig-prename descclassname"><span class="pre">q3dfit.q3dutil.</span></span><span class="sig-name descname"><span class="pre">get_q3dio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inobj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/q3dutil.html#get_q3dio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.q3dutil.get_q3dio" title="Link to this definition"></a></dt>
<dd><p>Load initialization or output object. Determine whether it’s already an object,
or needs to be loaded from file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inobj</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></span>) – Input object. If a string, assume it’s an input .npy file. If an ndarray,
assume the file’s been loaded but not stripped to dict{}. If an object,
assume all is well.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>InitializationError</strong> – </p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>object</em> – <a class="reference internal" href="#q3dfit.q3din.q3din" title="q3dfit.q3din.q3din"><code class="xref py py-class docutils literal notranslate"><span class="pre">q3din</span></code></a> or <code class="xref py py-class docutils literal notranslate"><span class="pre">q3dout</span></code> object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.q3dutil.get_spaxels">
<span class="sig-prename descclassname"><span class="pre">q3dfit.q3dutil.</span></span><span class="sig-name descname"><span class="pre">get_spaxels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/q3dutil.html#get_spaxels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.q3dutil.get_spaxels" title="Link to this definition"></a></dt>
<dd><p>Set up 1D arrays specifying column value and row value for each spaxel to be
fitted. These are zero-offset for indexing other arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ncols</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Total number of columns in the data cube.</p></li>
<li><p><strong>nrows</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Total number of rows in the data cube.</p></li>
<li><p><strong>cols</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>) – Optional. Column values for spaxels to be fitted. Default is None, which means
all columns will be fitted. If a scalar, only that column will be fitted. If a
2-element list or array, the elements are the starting and ending columns to be
fitted. Unity-offset values assumed.</p></li>
<li><p><strong>rows</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span>) – Optional. Row values for spaxels to be fitted. Default is None, which means
all rows will be fitted. If a scalar, only that row will be fitted. If a
2-element list or array, the elements are the starting and ending rows to be
fitted. Unity-offset values assumed.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>int</em> – Number of spaxels to be fitted.</p></li>
<li><p><em>np.ndarray[int]</em> – 1D array of column values for spaxels to be fitted.</p></li>
<li><p><em>np.ndarray[int]</em> – 1D array of row values for spaxels to be fitted.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.q3dutil.write_msg">
<span class="sig-prename descclassname"><span class="pre">q3dfit.q3dutil.</span></span><span class="sig-name descname"><span class="pre">write_msg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/q3dutil.html#write_msg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.q3dutil.write_msg" title="Link to this definition"></a></dt>
<dd><p>Write message to log file and/or <code class="xref py py-func docutils literal notranslate"><span class="pre">stdout()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Message to be written</p></li>
<li><p><strong>logfile</strong> – Optional. Filename for progress messages. Default is None, which
means no message is written to a file.</p></li>
<li><p><strong>quiet</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Suppress progress messages to stdout. Default is True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="q3dfit.q3dutil.lmlabel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">q3dfit.q3dutil.</span></span><span class="sig-name descname"><span class="pre">lmlabel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/q3dutil.html#lmlabel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.q3dutil.lmlabel" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Remove characters from a label string that are incompatible with LMFIT’s
parser; or reverse the operation.</p>
<p>All keys of a Parameters() instance must be strings and valid Python symbol
names. This class replaces incompatible characters with valid symbols.</p>
<p><a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html#lmfit.parameter.Parameters">https://lmfit.github.io/lmfit-py/parameters.html#lmfit.parameter.Parameters</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Input label string.</p></li>
<li><p><strong>reverse</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. If set, reverse the operation. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>label</strong> – Original label string.</p></li>
<li><p><strong>lmlabel</strong> – Label string with incompatible characters replaced by valid symbols.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-q3dfit.qsohostfcn">
<span id="qsohostfcn"></span><h2>qsohostfcn<a class="headerlink" href="#module-q3dfit.qsohostfcn" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.qsohostfcn.qso_mult_exp">
<span class="sig-prename descclassname"><span class="pre">q3dfit.qsohostfcn.</span></span><span class="sig-name descname"><span class="pre">qso_mult_exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qsotemplate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/qsohostfcn.html#qso_mult_exp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.qsohostfcn.qso_mult_exp" title="Link to this definition"></a></dt>
<dd><p>Model exponentials for qso template multiplier</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<span class="sphinx_autodoc_typehints-type">ArrayLike</span>) – 1-D array of wavelengths</p></li>
<li><p><strong>qsotemplate</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – 1-D array of the quasar spectrum to be fit</p></li>
<li><p><strong>a</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factor for constant term</p></li>
<li><p><strong>b</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factor for exponential decay</p></li>
<li><p><strong>c</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – exponential decay constant</p></li>
<li><p><strong>d</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factor for exponential decay in reverse</p></li>
<li><p><strong>e</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – exponential decay constant in reverse</p></li>
<li><p><strong>f</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factor for exponential rise</p></li>
<li><p><strong>g</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – exponential rise constant</p></li>
<li><p><strong>h</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factor for exponential rise in reverse</p></li>
<li><p><strong>i</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – exponential rise constant in reverse</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>np.ndarray</em> – Multiplicative factor times the quasar spectrum</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.qsohostfcn.setup_qso_mult_exp">
<span class="sig-prename descclassname"><span class="pre">q3dfit.qsohostfcn.</span></span><span class="sig-name descname"><span class="pre">setup_qso_mult_exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/qsohostfcn.html#setup_qso_mult_exp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.qsohostfcn.setup_qso_mult_exp" title="Link to this definition"></a></dt>
<dd><p>Set up model exponentials for qso template multiplier</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>p</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – list of initial guesses for the exponential fit parameters a-i</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.Model" title="(in lmfit v1.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>, <a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html#lmfit.parameter.Parameters" title="(in lmfit v1.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>lmfit.Model</em> – lmfit model for the qso template multiplier</p></li>
<li><p><em>lmfit.Parameters</em> – lmfit parameters for the qso template multiplier</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.qsohostfcn.qso_mult_leg">
<span class="sig-prename descclassname"><span class="pre">q3dfit.qsohostfcn.</span></span><span class="sig-name descname"><span class="pre">qso_mult_leg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qsotemplate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">o</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/qsohostfcn.html#qso_mult_leg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.qsohostfcn.qso_mult_leg" title="Link to this definition"></a></dt>
<dd><p>Model legendre polys for qso template multiplier</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<span class="sphinx_autodoc_typehints-type">ArrayLike</span>) – 1-D array of wavelengths</p></li>
<li><p><strong>qsotemplate</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – 1-D array of the quasar spectrum to be fit</p></li>
<li><p><strong>i</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factors for 1-10 order legendre polynomials. 0th order
is the constant term and is set to 0.</p></li>
<li><p><strong>j</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factors for 1-10 order legendre polynomials. 0th order
is the constant term and is set to 0.</p></li>
<li><p><strong>k</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factors for 1-10 order legendre polynomials. 0th order
is the constant term and is set to 0.</p></li>
<li><p><strong>l</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factors for 1-10 order legendre polynomials. 0th order
is the constant term and is set to 0.</p></li>
<li><p><strong>m</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factors for 1-10 order legendre polynomials. 0th order
is the constant term and is set to 0.</p></li>
<li><p><strong>n</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factors for 1-10 order legendre polynomials. 0th order
is the constant term and is set to 0.</p></li>
<li><p><strong>o</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factors for 1-10 order legendre polynomials. 0th order
is the constant term and is set to 0.</p></li>
<li><p><strong>p</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factors for 1-10 order legendre polynomials. 0th order
is the constant term and is set to 0.</p></li>
<li><p><strong>q</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factors for 1-10 order legendre polynomials. 0th order
is the constant term and is set to 0.</p></li>
<li><p><strong>r</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factors for 1-10 order legendre polynomials. 0th order
is the constant term and is set to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>np.ndarray</em> – Multiplicative factor times the quasar spectrum</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.qsohostfcn.setup_qso_mult_leg">
<span class="sig-prename descclassname"><span class="pre">q3dfit.qsohostfcn.</span></span><span class="sig-name descname"><span class="pre">setup_qso_mult_leg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/qsohostfcn.html#setup_qso_mult_leg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.qsohostfcn.setup_qso_mult_leg" title="Link to this definition"></a></dt>
<dd><p>Set up model legendre polys for qso template multiplier</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>p</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – list of initial guesses for the exponential fit parameters a-i</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.Model" title="(in lmfit v1.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>, <a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html#lmfit.parameter.Parameters" title="(in lmfit v1.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>lmfit.Model</em> – lmfit model for the qso template multiplier</p></li>
<li><p><em>lmfit.Parameters</em> – lmfit parameters for the qso template multiplier</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.qsohostfcn.stars_add_leg">
<span class="sig-prename descclassname"><span class="pre">q3dfit.qsohostfcn.</span></span><span class="sig-name descname"><span class="pre">stars_add_leg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">o</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/qsohostfcn.html#stars_add_leg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.qsohostfcn.stars_add_leg" title="Link to this definition"></a></dt>
<dd><p>Model legendre for additive starlight continuum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<span class="sphinx_autodoc_typehints-type">ArrayLike</span>) – 1-D array of wavelengths</p></li>
<li><p><strong>i</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factors for 1-10 order legendre polynomials. 0th order
is the constant term and is set to 0.</p></li>
<li><p><strong>j</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factors for 1-10 order legendre polynomials. 0th order
is the constant term and is set to 0.</p></li>
<li><p><strong>k</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factors for 1-10 order legendre polynomials. 0th order
is the constant term and is set to 0.</p></li>
<li><p><strong>l</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factors for 1-10 order legendre polynomials. 0th order
is the constant term and is set to 0.</p></li>
<li><p><strong>m</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factors for 1-10 order legendre polynomials. 0th order
is the constant term and is set to 0.</p></li>
<li><p><strong>n</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factors for 1-10 order legendre polynomials. 0th order
is the constant term and is set to 0.</p></li>
<li><p><strong>o</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factors for 1-10 order legendre polynomials. 0th order
is the constant term and is set to 0.</p></li>
<li><p><strong>p</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factors for 1-10 order legendre polynomials. 0th order
is the constant term and is set to 0.</p></li>
<li><p><strong>q</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factors for 1-10 order legendre polynomials. 0th order
is the constant term and is set to 0.</p></li>
<li><p><strong>r</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factors for 1-10 order legendre polynomials. 0th order
is the constant term and is set to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>np.ndarray</em> – Polynomial model for the additive starlight continuum</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.qsohostfcn.setup_stars_add_leg">
<span class="sig-prename descclassname"><span class="pre">q3dfit.qsohostfcn.</span></span><span class="sig-name descname"><span class="pre">setup_stars_add_leg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/qsohostfcn.html#setup_stars_add_leg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.qsohostfcn.setup_stars_add_leg" title="Link to this definition"></a></dt>
<dd><p>Set up model legendre for additive starlight continuum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>p</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – list of initial guess for the legendre polynomial</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.Model" title="(in lmfit v1.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>, <a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html#lmfit.parameter.Parameters" title="(in lmfit v1.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>lmfit.Model</em> – lmfit model for the additive starlight continuum</p></li>
<li><p><em>lmfit.Parameters</em> – lmfit parameters for the additive starlight continuum</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.qsohostfcn.stars_add_exp">
<span class="sig-prename descclassname"><span class="pre">q3dfit.qsohostfcn.</span></span><span class="sig-name descname"><span class="pre">stars_add_exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/qsohostfcn.html#stars_add_exp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.qsohostfcn.stars_add_exp" title="Link to this definition"></a></dt>
<dd><p>Model exponentials for additive starlight continuum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<span class="sphinx_autodoc_typehints-type">ArrayLike</span>) – 1-D array of the wavelength to be fit</p></li>
<li><p><strong>a</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factor for constant term</p></li>
<li><p><strong>b</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factor for exponential decay</p></li>
<li><p><strong>c</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – exponential decay constant</p></li>
<li><p><strong>d</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factor for exponential decay in reverse</p></li>
<li><p><strong>e</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – exponential decay constant in reverse</p></li>
<li><p><strong>f</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factor for exponential rise</p></li>
<li><p><strong>g</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – exponential rise constant</p></li>
<li><p><strong>h</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – scale factor for exponential rise in reverse</p></li>
<li><p><strong>i</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – exponential rise constant in reverse</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>np.ndarray</em> – Exponential model for the additive starlight continuum</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.qsohostfcn.setup_stars_add_exp">
<span class="sig-prename descclassname"><span class="pre">q3dfit.qsohostfcn.</span></span><span class="sig-name descname"><span class="pre">setup_stars_add_exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/qsohostfcn.html#setup_stars_add_exp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.qsohostfcn.setup_stars_add_exp" title="Link to this definition"></a></dt>
<dd><p>Set up model exponentials for additive starlight continuum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>p</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – list of initial guess for the legendre polynomial fit</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.Model" title="(in lmfit v1.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>, <a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html#lmfit.parameter.Parameters" title="(in lmfit v1.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>lmfit.Model</em> – lmfit model for the additive starlight continuum</p></li>
<li><p><em>lmfit.Parameters</em> – lmfit parameters for the additive starlight continuum</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.qsohostfcn.qsohostfcn">
<span class="sig-prename descclassname"><span class="pre">q3dfit.qsohostfcn.</span></span><span class="sig-name descname"><span class="pre">qsohostfcn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qsoflux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qsoonly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qsoord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hostonly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hostord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blronly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blrpar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">medflux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/qsohostfcn.html#qsohostfcn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.qsohostfcn.qsohostfcn" title="Link to this definition"></a></dt>
<dd><p>Set up or evaluate the model for the QSO and host galaxy featureless
continuum fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – 1-D array of wavelengths</p></li>
<li><p><strong>params_fit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>]</span>) – Optional. Dictionary of parameters to evaluate the model. If None,
the function returns the lmfit model object and parameter object for fitting.
If not None, the function returns the model evaluated at the
parameters in params_fit.</p></li>
<li><p><strong>qsoflux</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]</span>) – Optional. 1-D array of the quasar template flux. Only needed if
params_fit is not None.</p></li>
<li><p><strong>qsoonly</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Fit/evaluate only the QSO component. Default is False.</p></li>
<li><p><strong>qsoord</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – Optional. Order of the Legendre polynomial for the QSO template multiplier.
Default is None, which means no Legendre polynomial is used. The maximum
order is 10.</p></li>
<li><p><strong>hostonly</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Fit/evaluate only the host galaxy component. Default is False.</p></li>
<li><p><strong>hostord</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – Optional. Order of the Legendre polynomial for the host galaxy template
multiplier. Default is None, which means no Legendre polynomial is used.
The maximum order is 10.</p></li>
<li><p><strong>blronly</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Optional. Fit/evaluate only the scattered-light broad line region component.
Default is False.</p></li>
<li><p><strong>blrpar</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[ArrayLike]</span>) – Optional. Array of parameters for the broad line region model. Only needed
if scattered light broad line region component is included. Default is None.
Must be in the form [amplitude, center, sigma, amplitude, center, sigma, …],
where each set of three parameters is for a single Gaussian component.
The center is not varied in the fit, and the bounds on the sigma are set to
2000 and 6000 km/s.</p></li>
<li><p><strong>medflux</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</span>) – Optional. Estimate for the continuum level for setting initial guesses.
Default is None, which sets the continuum level to 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-q3dfit.questfitfcn">
<span id="questfitfcn"></span><h2>questfitfcn<a class="headerlink" href="#module-q3dfit.questfitfcn" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.questfitfcn.blackbody">
<span class="sig-prename descclassname"><span class="pre">q3dfit.questfitfcn.</span></span><span class="sig-name descname"><span class="pre">blackbody</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/questfitfcn.html#blackbody"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.questfitfcn.blackbody" title="Link to this definition"></a></dt>
<dd><p>Blackbody model function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – 1-D array of the wavelength to be fit, in microns.</p></li>
<li><p><strong>a</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Scale factor for blackbody model after it is normalized to its maximum value.</p></li>
<li><p><strong>T</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Temperature of the blackbody in Kelvin.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>BB_model</strong> (<em>array</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.questfitfcn.set_up_fit_blackbody_model">
<span class="sig-prename descclassname"><span class="pre">q3dfit.questfitfcn.</span></span><span class="sig-name descname"><span class="pre">set_up_fit_blackbody_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_fixfree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/questfitfcn.html#set_up_fit_blackbody_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.questfitfcn.set_up_fit_blackbody_model" title="Link to this definition"></a></dt>
<dd><p>Function defined to set up fitting blackbody_model within lmfit</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a></span>) – List of initial guesses for the normalization and T of the blackbody model fit.
Limits on the temperature are set to 50-3000 K. Lower limit on the normalization
is the minimum positive float value.</p></li>
<li><p><strong>p_fixfree</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a></span>) – List of fix/free values (0/1) for the blackbody model parameters.</p></li>
<li><p><strong>name</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Name of the blackbody model, for labeling.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.Model" title="(in lmfit v1.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>, <a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html#lmfit.parameter.Parameters" title="(in lmfit v1.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>blackbody_model_model</strong> (<em>lmfit model</em>)</p></li>
<li><p><strong>blackbody_model_paramters</strong> (<em>lmfit model parameters</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.questfitfcn.powerlaw">
<span class="sig-prename descclassname"><span class="pre">q3dfit.questfitfcn.</span></span><span class="sig-name descname"><span class="pre">powerlaw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/questfitfcn.html#powerlaw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.questfitfcn.powerlaw" title="Link to this definition"></a></dt>
<dd><p>Powerlaw model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – 1-D array of the wavelength to be fit.</p></li>
<li><p><strong>a</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Scale factor the powerlaw model.</p></li>
<li><p><strong>b</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Exponent for powerlaw.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>np.ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.questfitfcn.set_up_fit_powerlaw_model">
<span class="sig-prename descclassname"><span class="pre">q3dfit.questfitfcn.</span></span><span class="sig-name descname"><span class="pre">set_up_fit_powerlaw_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_fixfree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/questfitfcn.html#set_up_fit_powerlaw_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.questfitfcn.set_up_fit_powerlaw_model" title="Link to this definition"></a></dt>
<dd><p>Set up fitting powerlaw_model within lmfit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<span class="sphinx_autodoc_typehints-type">ArrayLike</span>) – List of initial guesses for the normalization and exponent of the powerlaw model fit.
The lower limit on the normalization is the minimum positive float value.</p></li>
<li><p><strong>p_fixfree</strong> (<span class="sphinx_autodoc_typehints-type">ArrayLike</span>) – List of fix/free values (0/1) for the powerlaw model parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.Model" title="(in lmfit v1.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>, <a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html#lmfit.parameter.Parameters" title="(in lmfit v1.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>lmfit.Model</em></p></li>
<li><p><em>lmfit.Parameters</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.questfitfcn.model_scale">
<span class="sig-prename descclassname"><span class="pre">q3dfit.questfitfcn.</span></span><span class="sig-name descname"><span class="pre">model_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/questfitfcn.html#model_scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.questfitfcn.model_scale" title="Link to this definition"></a></dt>
<dd><p>Scale a model by a factor a.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – The model to be scaled.</p></li>
<li><p><strong>a</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Scale factor.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>np.ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.questfitfcn.set_up_fit_model_scale">
<span class="sig-prename descclassname"><span class="pre">q3dfit.questfitfcn.</span></span><span class="sig-name descname"><span class="pre">set_up_fit_model_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_fixfree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/questfitfcn.html#set_up_fit_model_scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.questfitfcn.set_up_fit_model_scale" title="Link to this definition"></a></dt>
<dd><p>Set up fitting model_scale within lmfit</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<span class="sphinx_autodoc_typehints-type">ArrayLike</span>) – List containing initial guess for the scale factor. The lower limit on the scale
factor is the minimum positive float value. If maxamp is not None, the upper limit
is set to maxamp.</p></li>
<li><p><strong>p_fixfree</strong> (<span class="sphinx_autodoc_typehints-type">ArrayLike</span>) – List containing fix/free value (0/1) for the scale factor.</p></li>
<li><p><strong>model_name</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Name of the scaled model.</p></li>
<li><p><strong>model</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Name of the model to be scaled.</p></li>
<li><p><strong>maxamp</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</span>) – Optional. Maximum value for the scale factor. If None, the maximum value is not set.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.Model" title="(in lmfit v1.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>, <a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html#lmfit.parameter.Parameters" title="(in lmfit v1.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>lmfit.Model</em></p></li>
<li><p><em>lmfit.Parameters</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.questfitfcn.set_up_absorption">
<span class="sig-prename descclassname"><span class="pre">q3dfit.questfitfcn.</span></span><span class="sig-name descname"><span class="pre">set_up_absorption</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_fixfree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abs_model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/questfitfcn.html#set_up_absorption"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.questfitfcn.set_up_absorption" title="Link to this definition"></a></dt>
<dd><p>Set up fitting ice absorption model within lmfit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<span class="sphinx_autodoc_typehints-type">ArrayLike</span>) – List containing initial guess for the tau of the absorption model.
The lower limit on tau is the minimum positive float value, and the upper limit is 10.</p></li>
<li><p><strong>p_fixfree</strong> (<span class="sphinx_autodoc_typehints-type">ArrayLike</span>) – List containing fix/free value (0/1) for tau.</p></li>
<li><p><strong>model_name</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Name for the output model.</p></li>
<li><p><strong>abs_model</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Name of the absorption model with values of tau.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.Model" title="(in lmfit v1.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>, <a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html#lmfit.parameter.Parameters" title="(in lmfit v1.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>lmfit.Model</em></p></li>
<li><p><em>lmfit.Parameters</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="q3dfit.questfitfcn.set_up_fit_extinction">
<span class="sig-prename descclassname"><span class="pre">q3dfit.questfitfcn.</span></span><span class="sig-name descname"><span class="pre">set_up_fit_extinction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_fixfree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extinction_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixed_or_screen</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/q3dfit/questfitfcn.html#set_up_fit_extinction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#q3dfit.questfitfcn.set_up_fit_extinction" title="Link to this definition"></a></dt>
<dd><p>Set up extinction fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<span class="sphinx_autodoc_typehints-type">ArrayLike</span>) – List containing initial guess for A_V. The lower limit on A_V is the minimum
positive float value, and the upper limit is 100.</p></li>
<li><p><strong>p_fixfree</strong> (<span class="sphinx_autodoc_typehints-type">ArrayLike</span>) – List containing fix/free value (0/1) for A_V.</p></li>
<li><p><strong>model_name</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Name for extincted model.</p></li>
<li><p><strong>extinction_model</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Name of extinction curve containing values A_lambda.</p></li>
<li><p><strong>mixed_or_screen</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'M'</span></code>, <code class="docutils literal notranslate"><span class="pre">'S'</span></code>]</span>) – ‘M’ for mixed model, ‘S’ for screen model.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.Model" title="(in lmfit v1.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>, <a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html#lmfit.parameter.Parameters" title="(in lmfit v1.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>lmfit.Model</em></p></li>
<li><p><em>lmfit.Parameters</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../MIR-configuration.html" class="btn btn-neutral float-left" title="MIR Configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, David Rupke and the Q3D Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>